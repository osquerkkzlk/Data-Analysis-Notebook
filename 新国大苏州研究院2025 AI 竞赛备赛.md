- [æ–°å›½å¤§è‹å·ç ”ç©¶é™¢2025 AI ç«èµ›å¤‡èµ›](#--------2025-ai-----)
  * [1.çŸ¥è¯†è¡¥å……](#1----)
    + [1.locå’Œiloc](#1loc-iloc)
    + [2.appendå’Œextend](#2append-extend)
    + [3.æŒ‰é”®æŠ€å·§](#3----)
    + [4. vlaue_counts](#4-vlaue-counts)
    + [5.hist](#5hist)
    + [6.  pd.crosstab](#6--pdcrosstab)
    + [7.seaborn å¿«é€Ÿå¯è§†åŒ–](#7seaborn------)
    + [8.drop](#8drop)
    + [9. fitï¼Œscoreï¼Œtransformeræ–¹æ³•](#9-fit-score-transformer--)
    + [10.data.dtypes](#10datadtypes)
    + [11. unique](#11-unique)
    + [12.OrdinalEncoder å’Œ OneHotEncoder](#12ordinalencoder---onehotencoder)
      - [1ï¸âƒ£ OrdinalEncoder çš„æœ¬è´¨](#1---ordinalencoder----)
      - [2ï¸âƒ£ å¯¹ä¸åŒæ¨¡å‹çš„å½±å“](#2-----------)
      - [3ï¸âƒ£ OneHotEncoder çš„å±€é™](#3---onehotencoder----)
    + [13ã€warning](#13-warning)
    + [14ã€sample](#14-sample)
    + [15ã€info()](#15-info--)
    + [16ã€å¿«é€ŸæŸ¥çœ‹ç¼ºå¤±å€¼](#16--------)
    + [17ã€ravelï¼ˆï¼‰](#17-ravel--)
    + [18ã€ç”»å›¾](#18---)
    + [19ã€predict_proba](#19-predict-proba)
    + [20ã€è§£å†³éçº¿æ€§é—®é¢˜](#20--------)
    + [21ã€np.log1p å’Œ np.expm1](#21-nplog1p---npexpm1)
    + [22ã€æ¿€æ´»ä¸ä¸¢å¼ƒ](#22------)
    + [23ã€apply](#23-apply)
    + [24ã€mseå’Œrmse](#24-mse-rmse)
    + [25ã€ è¿‡æ‹Ÿåˆä¸æ¬ æ‹Ÿåˆ](#25---------)
    + [26ã€ShuffleSplit](#26-shufflesplit)
    + [27ã€è¯„åˆ†æŒ‡æ ‡](#27-----)
    + [28ã€æ˜¾ç¤ºæŸä¸€åˆ—æ•°æ®çš„åˆ†å¸ƒ](#28-----------)
    + [29ã€è¯¯å·®æŒ‡æ ‡](#29-----)
    + [30ã€cross_val_score](#30-cross-val-score)
    + [31ã€ä½¿ç”¨  KNeighborsClassifier](#31-----kneighborsclassifier)
    + [32ã€train_test_split](#32-train-test-split)
    + [33ã€ item  å’Œ  detach](#33--item-----detach)
    + [34ã€np.arange](#34-nparange)
    + [35ã€BCEWithLogitsLoss ï¼ˆäºŒåˆ†ç±»ä»»åŠ¡ï¼‰](#35-bcewithlogitsloss--------)
    + [36ã€lossæ³¨æ„ç‚¹](#36-loss---)
    + [37ã€make_column_selector](#37-make-column-selector)
    + [38ã€æ ‘æ¨¡å‹ç‰¹ç‚¹](#38------)
    + [39ã€ç¡®å®šæ¨¡å‹æœ€ä½³è¶…å‚æ•°](#39----------)
    + [40ã€renameï¼ˆé‡å‘½åï¼‰](#40-rename-----)
    + [41ã€rsplitï¼ˆä»å³è¾¹å¼€å§‹åˆ†å‰²å­—ç¬¦ä¸²ï¼‰](#41-rsplit------------)
    + [42ã€åµŒå¥—äº¤å‰éªŒè¯](#42-------)
    + [43ã€RandomizedSearchCV](#43-randomizedsearchcv)
    + [44ã€np.logspace](#44-nplogspace)
    + [45ã€astype ï¼ˆå¼ºåˆ¶è½¬æ¢ç±»åˆ«ï¼‰](#45-astype---------)
    + [46ã€cv](#46-cv)
    + [47ã€pandas ç‰¹æ€§](#47-pandas---)
    + [48ã€balanced_accuracy](#48-balanced-accuracy)
    + [49ã€sort_values()](#49-sort-values--)
    + [50ã€list(x:str)](#50-list-x-str-)
    + [51ã€reset_index](#51-reset-index)
    + [52ã€ç¡¬é¢„æµ‹å’Œè½¯é¢„æµ‹](#52--------)
    + [53ã€==çº¿æ€§æ¨¡å‹çš„å‚æ•°==](#53------------)
    + [54ã€sklearnæ•°æ®ç‰¹å¾](#54-sklearn----)
    + [55ã€np.concatenate](#55-npconcatenate)
    + [56ã€Nystroem](#56-nystroem)
    + [57ã€ValidationCurveDisplay](#57-validationcurvedisplay)
    + [58ã€ListedColormapï¼ˆè‡ªå®šä¹‰é¢œè‰²æ˜ å°„ï¼‰](#58-listedcolormap---------)
    + [59ã€å­å›¾](#59---)
    + [60ã€é€»è¾‘å›å½’](#60-----)
    + [61ã€KBinsDiscretizer](#61-kbinsdiscretizer)
    + [62ã€==transformer ï¼ˆç»å…¸æœºå™¨å­¦ä¹ ï¼‰åˆè°ˆ==](#62---transformer-------------)
    + [63ã€çº¿æ€§å¯åˆ†ç¦»](#63------)
    + [64ã€çº¿æ€§æ¨¡å‹](#64-----)
    + [65ã€æ•°æ®ç¼©æ”¾](#65-----)
    + [66ã€RidgeCV](#66-ridgecv)
    + [67ã€aggregate(["mean", "std"])](#67-aggregate---mean----std---)
    + [68ã€é€»è¾‘å›å½’ä¸­çš„æƒ©ç½šé¡¹ C](#68-----------c)
    + [69ã€ç®±çº¿å›¾](#69----)
    + [70ã€OnehotEncoder](#70-onehotencoder)
    + [71ã€å˜æ¢å™¨](#71----)
    + [72ã€RandomResizedCropï¼ˆè£å‰ªå›¾åƒï¼‰](#72-randomresizedcrop------)
    + [73ã€å¼ é‡æ‹¼æ¥](#73-----)
    + [74ã€æŸå¤±ï¼ˆtorchï¼‰](#74----torch-)
    + [75ã€argmax](#75-argmax)
    + [76ã€sum](#76-sum)
    + [77ã€item](#77-item)
    + [78ã€å…ƒç»„](#78---)
    + [79ã€è§†è§‰æ¨¡å‹](#79-----)
    + [80ã€GAPï¼ˆå…¨å±€å¹³å‡æ± åŒ–ï¼‰](#80-gap--------)
    + [81ã€å·ç§¯](#81---)
    + [82ã€æ¿€æ´»å‡½æ•°](#82-----)
    + [83ã€torchvision.io.read_image](#83-torchvisionioread-image)
    + [84ã€æ ‡ç­¾ï¼ˆtorchï¼‰](#84----torch-)
    + [85ã€LabelEncoder](#85-labelencoder)
    + [86ã€arrayå’Œndarray](#86-array-ndarray)
    + [87ã€ToPILImage](#87-topilimage)
    + [88ã€listdirï¼ˆï¼‰](#88-listdir--)
    + [89ã€å­¦ä¹ ç‡è°ƒåº¦å™¨ï¼ˆç²¾ç®€ç‰ˆï¼‰](#89------------)
    + [90ã€Dataloaderç‰¹æ€§](#90-dataloader--)
    + [91ã€DecisionBoundaryDisplay (ç»˜åˆ¶å†³ç­–è¾¹ç•Œ)](#91-decisionboundarydisplay---------)
    + [92ã€ç»˜åˆ¶ç¦»æ•£ç‚¹ï¼ˆsnsï¼‰](#92-------sns-)
    + [93ã€å›¾åƒæ ‡ç­¾](#93-----)
    + [94ã€å‚æ•°æ¨¡å‹å’Œéå‚æ•°æ¨¡å‹](#94-----------)
    + [95ã€æ ‘æ¨¡å‹çš„å¯è§†åŒ–](#95--------)
    + [96ã€å†³ç­–æ ‘åˆ†ç±»å™¨](#96-------)
    + [97ã€æ–°å»ºæ•°æ®ï¼ˆpdï¼‰](#97------pd-)
    + [98ã€pdæ•°æ®ç‰¹æ€§](#98-pd----)
    + [99ã€è®­ç»ƒä¸é¢„æµ‹ï¼ˆsklearnï¼‰](#99-------sklearn-)
    + [100ã€ç»˜å›¾é¢œè‰²](#100-----)
    + [101ã€å†³ç­–æ ‘çš„è¶…å‚æ•°](#101--------)
    + [102ã€%%time](#102---time)
    + [103ã€bagging](#103-bagging)
    + [104ã€cv_resultsï¼ˆæœç´¢æ—¥å¿—ï¼‰](#104-cv-results------)
    + [105ã€baggingä¸éšæœºæ£®æ—](#105-bagging-----)
    + [106ã€ç¼–ç ](#106---)
    + [107ã€make_column_transformer](#107-make-column-transformer)
    + [108ã€ç¼–ç æ ¼å¼å¯¹æ¯”](#108-------)
    + [109ã€é›†æˆæ¨¡å‹](#109-----)
    + [110ã€nonzeroã€flatnonzero](#110-nonzero-flatnonzero)
    + [111ã€np.intersect1d](#111-npintersect1d)
    + [112ã€AdaBoostï¼ˆboostingï¼‰](#112-adaboost-boosting-)
    + [113ã€GBDTï¼ˆæ¢¯åº¦æå‡å†³ç­–æ ‘ï¼‰ï¼ˆboostingï¼‰](#113-gbdt----------boosting-)
    + [114ã€ax.set_xlim](#114-axset-xlim)
    + [115ã€baggingå’Œboosting](#115-bagging-boosting)
    + [116ã€KBinsDiscretizer (åˆ†ç®±ç¦»æ•£åŒ–å™¨)](#116-kbinsdiscretizer---------)
    + [117ã€negateå‚æ•°](#117-negate--)
    + [118ã€HistGradientBoostingï¼ˆåˆ†ç±»å™¨æˆ–è€…å›å½’å™¨ï¼‰](#118-histgradientboosting----------)
    + [119ã€é¢„æµ‹å› å­](#119-----)
    + [120ã€åµŒå¥—äº¤å‰éªŒè¯](#120-------)
    + [121ã€å¿«é€Ÿåˆ é™¤ç¼ºå¤±å€¼](#121--------)
    + [122ã€sampleï¼ˆéšæœºæŠ½å–æ•°æ®ï¼‰](#122-sample--------)
    + [133ã€å‚æ•°n_estimators å’Œå‚æ•°max_iter](#133---n-estimators----max-iter)
    + [134ã€è¯„ä¼°æŒ‡æ ‡](#134-----)
    + [135ã€dropæ–¹æ³•](#135-drop--)
    + [136ã€npæ•°æ®å’Œtorchæ•°æ®](#136-np---torch--)
    + [137ã€åˆ›å»ºå­å›¾](#137-----)
    + [138ã€lenå‡½æ•°](#138-len--)
    + [139ã€v2.RandomAffine](#139-v2randomaffine)
    + [140ã€åŸºçº¿æ¨¡å‹](#140-----)
    + [141ã€äº¤å‰éªŒè¯](#141-----)
    + [142ã€æ ‡ç­¾](#142---)
    + [143ã€è¯„ä¼°æŒ‡æ ‡](#143-----)
    + [144ã€æ˜¾ç¤ºå‡½æ•°ï¼ˆsklearnï¼‰](#144------sklearn-)
    + [145ã€make_scorerï¼ˆè®¾ç½®è¯„åˆ†ï¼‰](#145-make-scorer------)
    + [146ã€pd.factorize(ç¼–ç )](#146-pdfactorize----)
    + [147ã€èšç±»](#147---)
    + [148ã€silhouette_scoreï¼ˆè½®å»“ç³»æ•°ï¼‰](#148-silhouette-score------)
    + [149ã€æ•°æ®æ ‡å‡†åŒ–](#149------)
    + [150ã€isna(pandasæ•°æ®)](#150-isna-pandas---)
    + [151ã€æ•°æ®å¯è§†åŒ–](#151------)
    + [152ã€kaggleæäº¤](#152-kaggle--)
    + [153ã€whereå’Œapply](#153-where-apply)
    + [154ã€cbrt](#154-cbrt)
    + [155ã€pd.qcut()](#155-pdqcut--)
    + [156ã€plt.legend()](#156-pltlegend--)
    + [157ã€roc_auc_score](#157-roc-auc-score)
    + [158ã€transformå˜æ¢](#158-transform--)
    + [159ã€combinations](#159-combinations)
    + [160ã€dataloader å’Œdataset](#160-dataloader--dataset)
    + [162ã€requires_grad](#162-requires-grad)
    + [163ã€åˆ†ç±»ä»»åŠ¡](#163-----)
    + [164ã€dropnaæ–¹æ³•](#164-dropna--)
    + [165ã€Imputer](#165-imputer)
    + [166ã€XGB](#166-xgb)
    + [167ã€Hyperopt](#167-hyperopt)
      - [1ã€åŸºæœ¬æ–¹æ³•](#1-----)
      - [2ã€è¿”å›å€¼](#2----)
      - [3ã€è§£å†³é—®é¢˜çš„ä¸€èˆ¬æ­¥éª¤](#3----------)
    + [168ã€ç‰¹å¾å·¥ç¨‹](#168-----)
      - [1ã€MIï¼ˆäº’ä¿¡æ¯ï¼‰](#1-mi-----)
      - [2ã€å¤„ç†ç‰¹å¾](#2-----)
      - [3ã€PCAï¼ˆä¸»æˆåˆ†åˆ†æï¼‰](#3-pca-------)
      - [4ã€æ— ç›‘ç£å­¦ä¹ ](#4------)
    + [169ã€å¸ƒå°”å€¼](#169----)
    + [170ã€gt](#170-gt)
    + [171ã€è·¨è¡Œè¡¨è¾¾å¼](#171------)
    + [172ã€str  è®¿é—®å™¨](#172-str-----)
    + [172ã€mapå’Œapply](#172-map-apply)
    + [173ã€transform](#173-transform)
    + [174ã€mul](#174-mul)
    + [175ã€pd.get_dummies](#175-pdget-dummies)
    + [176ã€hueå‚æ•°](#176-hue--)
    + [177ã€popæ–¹æ³•](#177-pop--)
    + [178ã€cpoyæ–¹æ³•](#178-cpoy--)
    + [179ã€join ï¼ˆè¡Œç´¢å¼•å¯¹é½ï¼‰](#179-join--------)
    + [180ã€nunique  å’Œ  unique](#180-nunique-----unique)
    + [181ã€smapleæ–¹æ³•](#181-smaple--)
    + [182ã€ M-Estimate ç¼–ç ](#182--m-estimate---)
  * [2.é¡¹ç›®å¿ƒå¾—](#2----)
    + [1. `titanic` ç«èµ›](#1--titanic----)
    + [2.`house-price`ç«èµ›](#2-house-price---)
    + [3ã€` bank `ç«èµ›](#3---bank----)
    + [4ã€`CIFAR-10`ç«èµ›](#4--cifar-10---)
    + [5ã€`Kannada-MSIST` ç«èµ›](#5--kannada-msist----)
    + [6ã€`K-Means Clustering for Heart Disease Analysis` ç«èµ›](#6--k-means-clustering-for-heart-disease-analysis----)
    + [7ã€`bank`ç«èµ›ï¼ˆå›é¡¾ï¼Œé‡‡ç”¨ç»å…¸æœºå™¨å­¦ä¹ ï¼‰](#7--bank----------------)
      - [1ã€EDA](#1-eda)
      - [2ã€è¶…å‚æ•°æœç´¢](#2------)
      - [3ã€TEï¼ˆç±»åˆ«ç¼–ç ï¼‰](#3-te------)
      - [4ã€æ•°æ®æ˜¾ç¤º](#4-----)
    + [8ã€`cat and dog ` åˆ†ç±»ç«èµ›](#8--cat-and-dog-------)

<small><i><a href='http://ecotrust-canada.github.io/markdown-toc/'>Table of contents generated with markdown-toc</a></i></small>



# æ–°å›½å¤§è‹å·ç ”ç©¶é™¢2025 AI ç«èµ›å¤‡èµ›



## 1.çŸ¥è¯†è¡¥å……

### 1.locå’Œiloc

é¦–å…ˆï¼ŒäºŒè€…éƒ½æ˜¯pandasä¸­æŸ¥è¯¢æ•°æ®çš„æ–¹æ³•ã€‚ä¸åŒçš„æ˜¯ï¼Œlocæ˜¯æŒ‰åå­—è®¿é—®ï¼Œ`.loc[è¡Œç´¢å¼•, åˆ—ç´¢å¼•]` ï¼Œ

ilocæ˜¯æŒ‰ä½ç½®è®¿é—®ï¼Œ `.iloc[è¡Œä½ç½®, åˆ—ä½ç½®]`

| å†™æ³•    | ç´¢å¼•ä¾æ®             | è¡Œä¸ºç‰¹ç‚¹     |
| ------- | -------------------- | ------------ |
| `.loc`  | **æ ‡ç­¾ï¼ˆlabelï¼‰**    | åŒ…å«ç»“æŸç‚¹   |
| `.iloc` | **ä½ç½®ï¼ˆpositionï¼‰** | ä¸åŒ…å«ç»“æŸç‚¹ |

### 2.appendå’Œextend

appendä¼šå°†å…ƒç´ ç›´æ¥æ·»åŠ åˆ°åˆ—è¡¨æœ«å°¾ï¼Œå¾ˆå®¹æ˜“åµŒå¥—ï¼Œextendä¼šå°†å¯è¿­ä»£å¯¹è±¡ä¸­çš„å…ƒç´ é€ä¸ªæ·»åŠ åˆ°åˆ—è¡¨æœ«å°¾ã€‚



### 3.æŒ‰é”®æŠ€å·§

1. åˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªæ ‡ç­¾é¡µ	Ctrl + Tab æˆ– Ctrl + PgDn	
2. åˆ‡æ¢åˆ°ä¸Šä¸€ä¸ªæ ‡ç­¾é¡µ	Ctrl + Shift + Tab æˆ– Ctrl + PgUp	
3. å¿«é€Ÿåˆ‡æ¢ **æ¡Œé¢**       `Ctrl + Win + â†/â†’` 



### 4. vlaue_counts

å¯¹äºpandasæ•°æ®è€Œè¨€ï¼Œä½¿ç”¨`data.value_counts()`å¯ä»¥ç»Ÿè®¡dataæ•°æ®çš„ç±»åˆ«ï¼Œæœ€å¥½å¯¹seriesæ•°æ®å¤„ç†ï¼Œæ¯”å¦‚`data.Sex.value_counts()`



### 5.hist

pandasæ•°æ®å¯ç›´æ¥å±•ç¤ºæ•°æ®çš„æ•°å€¼ç±»å‹æ•°æ®çš„åˆ†å¸ƒ `_ =train.hist(figsize=(20,14))`,åŒæ—¶è¿”å›å±•ç¤ºçš„ç‰¹å¾åå­—ã€‚å¯ä»¥è¿›è¡Œç‰¹å®šæ¡ä»¶çº¦æŸï¼Œ

`_ =train[train["Survived"]==1].hist(figsize=(20,14))`



### 6.  pd.crosstab

```python
pd.crosstab(
    index=adult_census["education"], 
    columns=adult_census["education-num"]
)
```

ä½œç”¨æ˜¯**ç”Ÿæˆä¸€ä¸ªäº¤å‰è¡¨ï¼ˆé¢‘ç‡ç»Ÿè®¡è¡¨ï¼‰**ï¼Œè¡Œæ˜¯ `education`ï¼ˆå­¦å†ç±»åˆ«ï¼‰ï¼Œåˆ—æ˜¯ `education-num`ï¼ˆå­¦å†å¯¹åº”çš„æ•°å€¼ç¼–ç ï¼‰ï¼Œäº¤å‰ç‚¹æ˜¯**å‡ºç°æ¬¡æ•°**ã€‚

```python
pd.crosstab(
    index=adult_census["education"], 
    columns=adult_census["education-num"], 
    normalize="index"
)
```

è¿™æ ·ä¼šç™¾åˆ†æ¯”æ˜¾ç¤º

```python
pd.crosstab(
    index=adult_census["education"], 
    columns=adult_census["education-num"], 
    margins=True
)
```

è¿™æ ·ä¼šå¢åŠ æ€»è®¡



### 7.seaborn å¿«é€Ÿå¯è§†åŒ–

```python
_ = sns.pairplot(
    data=data,
    vars=columns, 
    hue=target_column,
    plot_kws={"alpha": 0.2},
    height=3,
    diag_kind="hist",
    diag_kws={"bins": 30},
)
```

| å‚æ•°                      | å«ä¹‰                                      |
| ------------------------- | ----------------------------------------- |
| `data=data`               | æ•°æ®                                      |
| `vars=columns`            | åªç»˜åˆ¶æŒ‡å®šç‰¹å¾åˆ—                          |
| `hue=target_column`       | æŒ‰ç›®æ ‡åˆ—ï¼ˆæ¯”å¦‚æ˜¯å¦æ”¶å…¥ >50Kï¼‰è¿›è¡Œé¢œè‰²åˆ†ç±» |
| `plot_kws={"alpha": 0.2}` | æ•£ç‚¹é€æ˜åº¦ä¸º 0.2ï¼Œæ–¹ä¾¿é‡å æ•°æ®çš„å¯è§†åŒ–    |
| `height=3`                | æ¯å¼ å­å›¾çš„é«˜åº¦ä¸º 3 è‹±å¯¸                   |
| `diag_kind="hist"`        | å¯¹è§’çº¿ä¸Šç»˜åˆ¶ç›´æ–¹å›¾ï¼Œè€Œä¸æ˜¯æ ¸å¯†åº¦ä¼°è®¡      |
| `diag_kws={"bins": 30}`   | å¯¹è§’çº¿ç›´æ–¹å›¾è®¾ç½® 30 ä¸ªæŸ±å­                |

==æ‰‹å†™å†³ç­–è§„åˆ™==

```python
_ = sns.scatterplot(
    x="age",
    y="hours-per-week",
    data=adult_census[:n_samples_to_plot],
    hue=target_column,
    alpha=0.5,
)
```



### 8.drop

```python
data = adult_census.drop(columns=[target_name])
```

åˆ é™¤ç‰¹å®šçš„åˆ—



### 9. fitï¼Œscoreï¼Œtransformeræ–¹æ³•

å…·æœ‰`fit`æ–¹æ³•çš„å¯¹è±¡ç§°ä¸ºä¼°è®¡å™¨ï¼Œæ­¤å¤–ï¼Œå®ƒè¿˜å…·æœ‰predictï¼ˆï¼‰å’Œtransform()æ–¹æ³•ã€‚

```python
accuracy = model.score(data_test, target_test)
```


 **è®¡ç®—æ¨¡å‹åœ¨æµ‹è¯•é›†ä¸Šçš„å‡†ç¡®ç‡ï¼ˆaccuracyï¼‰ ** **æ‰§è¡Œé€»è¾‘**

- `model`ï¼šè¿™é‡ŒæŒ‡çš„æ˜¯ä¸€ä¸ªå·²ç»è®­ç»ƒå¥½çš„æ¨¡å‹ï¼Œæ¯”å¦‚ `KNeighborsClassifier` æˆ– `LogisticRegression`ã€‚
- `.score(X, y)`ï¼š
  - å¯¹äºåˆ†ç±»æ¨¡å‹ï¼šè¿”å› **å‡†ç¡®ç‡**ï¼ˆaccuracyï¼‰ = é¢„æµ‹æ­£ç¡®çš„æ ·æœ¬æ•° Ã· æ€»æ ·æœ¬æ•°
  - å¯¹äºå›å½’æ¨¡å‹ï¼šè¿”å› **å†³å®šç³»æ•° RÂ²** åˆ†æ•°ã€‚
  - ä¸ç®¡æ˜¯äºŒåˆ†ç±»è¿˜æ˜¯å¤šåˆ†ç±»ï¼Œ`score` æ–¹æ³•é»˜è®¤éƒ½æ˜¯ç”¨ accuracyã€‚

### 10.data.dtypes

`data.dtypes`å¯ä»¥æ£€æŸ¥æ•°æ®é›†ä¸­æ¯åˆ—çš„æ•°æ®ç±»å‹ã€‚



### 11. unique

```
data.dtypes.unique()
```

uniqueå¯ä»¥æ‰¾åˆ°å”¯ä¸€çš„æ•°æ®æˆ–ç±»å‹



### 12.OrdinalEncoder å’Œ OneHotEncoder 

------

#### 1ï¸âƒ£ OrdinalEncoder çš„æœ¬è´¨

- **ä½œç”¨**ï¼šæŠŠç±»åˆ«å˜é‡è½¬æ¢ä¸ºæ•´æ•°ç¼–ç ï¼Œä¾‹å¦‚ï¼š

  ```
  "Low" â†’ 0
  "Medium" â†’ 1
  "High" â†’ 2
  ```

- **é‡è¦ç‰¹ç‚¹**ï¼šæ•´æ•°ç¼–ç éšå«äº† **é¡ºåºå…³ç³»**ï¼ˆ0 < 1 < 2ï¼‰ï¼Œä¹Ÿå°±æ˜¯æ¨¡å‹ä¼šâ€œè®¤ä¸ºâ€ç±»åˆ«ä¹‹é—´æœ‰å¤§å°å…³ç³»ã€‚

------

#### 2ï¸âƒ£ å¯¹ä¸åŒæ¨¡å‹çš„å½±å“

- **çº¿æ€§æ¨¡å‹ï¼ˆå¦‚ LogisticRegressionã€çº¿æ€§å›å½’ï¼‰**
  - çº¿æ€§æ¨¡å‹ä¼šè®¤ä¸ºæ•°å­—ä¹‹é—´æœ‰è¿ç»­æ€§å’Œé¡ºåºã€‚
  - å¦‚æœåŸå§‹ç±»åˆ«æœ¬èº«æ²¡æœ‰é¡ºåºï¼Œä½†ä½ ç”¨ OrdinalEncoderï¼Œæ¨¡å‹å¯èƒ½ä¼šè¯¯è§£å…³ç³»ï¼Œå¯¼è‡´é¢„æµ‹æ€§èƒ½ä¸‹é™ã€‚
  - âš ï¸ ä¾‹å¦‚ï¼ŒæŠŠé¢œè‰² ["Red", "Green", "Blue"] ç¼–ç ä¸º [0,1,2]ï¼Œæ¨¡å‹å¯èƒ½è®¤ä¸º Red < Green < Blueï¼Œè¿™æ˜¯é”™è¯¯çš„ã€‚
- **åŸºäºæ ‘çš„æ¨¡å‹ï¼ˆå¦‚ RandomForestã€LightGBMã€XGBoostï¼‰**
  - æ ‘æ¨¡å‹å…³æ³¨çš„æ˜¯ **åˆ†è£‚æ¡ä»¶**ï¼Œä¸ä¼šæŠŠæ•°å­—å½“ä½œè¿ç»­å˜é‡å¤„ç†ã€‚
  - å³ä½¿ç¼–ç ä¸æŒ‰å®é™…é¡ºåºï¼Œä¹Ÿä¸ä¼šå½±å“æ¨¡å‹æ€§èƒ½ï¼ˆæ ‘æ¨¡å‹åªå…³å¿ƒæŸä¸ªèŠ‚ç‚¹çš„åˆ†è£‚æ˜¯å¦èƒ½å¢åŠ ä¿¡æ¯å¢ç›Šï¼‰ã€‚

------

#### 3ï¸âƒ£ OneHotEncoder çš„å±€é™

- **OneHotEncoder** ä¼šæŠŠæ¯ä¸ªç±»åˆ«éƒ½å˜æˆä¸€åˆ—ï¼š

  ```
  "Red", "Green", "Blue" â†’ [1,0,0], [0,1,0], [0,0,1]
  ```

- å¦‚æœç±»åˆ«éå¸¸å¤šï¼ˆé«˜åŸºæ•°ï¼‰ï¼Œä¼šå¯¼è‡´ï¼š

  - æ•°æ®çŸ©é˜µç»´åº¦æ€¥å‰§å¢åŠ  â†’ è®¡ç®—æ•ˆç‡é™ä½
  - å¯èƒ½åœ¨æ ‘æ¨¡å‹ä¸­è®­ç»ƒæ›´æ…¢

- **æ€»ç»“**ï¼šé«˜åŸºæ•°åˆ†ç±»å˜é‡ï¼Œå¦‚æœæ¨¡å‹æ˜¯æ ‘ï¼Œæœ€å¥½ç”¨ OrdinalEncoderï¼›å¦‚æœæ¨¡å‹æ˜¯çº¿æ€§ï¼Œæœ€å¥½ç¡®ä¿ç¼–ç çš„é¡ºåºåˆç†ã€‚

------

ğŸ’¡ **æ ¸å¿ƒæ€æƒ³**ï¼š

1. OrdinalEncoder â†’ å¸¦é¡ºåºå‡è®¾ï¼Œé€‚åˆæœ‰åºç±»åˆ«æˆ–æ ‘æ¨¡å‹
2. OneHotEncoder â†’ ä¸å¸¦é¡ºåºå‡è®¾ï¼Œé€‚åˆçº¿æ€§æ¨¡å‹æˆ–ä½åŸºæ•°åˆ†ç±»
3. æ»¥ç”¨ OrdinalEncoder åœ¨çº¿æ€§æ¨¡å‹ä¸­å¯èƒ½å¼•å…¥â€œå‡é¡ºåºâ€é”™è¯¯
4. å•çƒ­ç¼–ç 

- 
   è¿™æ˜¯å•çƒ­ç¼–ç ï¼ˆOneHotEncoderï¼‰çš„æ ¸å¿ƒï¼šæ¯ä¸ªåŸå§‹ç±»åˆ«è¢«æ‹†åˆ†æˆä¸€ä¸ªç‹¬ç«‹çš„åˆ—ï¼Œå€¼ä¸º 0 æˆ– 1ã€‚
-  å•çƒ­ç¼–ç é€šå¸¸ä¼šå…ˆæŠŠç±»åˆ«æ˜ å°„æˆæ•´æ•°ï¼ˆ0,1,2â€¦ï¼‰ï¼Œå†è¿›è¡Œç‹¬çƒ­ç¼–ç ï¼Œè¿™éƒ¨åˆ†ä¹Ÿç®—æ˜¯â€œæ•°å€¼è¡¨ç¤ºå½¢å¼â€çš„è½¬æ¢ã€‚
-  å•çƒ­ç¼–ç æœ¬èº«ä¸æ”¹å˜åŸæœ¬æ˜¯æ•°å€¼çš„åˆ—ï¼Œå®ƒæ˜¯å¯¹ç±»åˆ«å‹ç‰¹å¾è¿›è¡Œæ‰©å±•ã€‚



### 13ã€warning

```python
import warnings
warnings.filterwarnings('ignore')
```

å¿½ç•¥è­¦å‘Š



### 14ã€sample

```
data.sample(3) 
```

éšæœºæŠ½å–ä¸‰è¡Œ



### 15ã€info()

```
data.info()
```

æŸ¥çœ‹æ•°æ®çš„æ¦‚è¦ä¿¡æ¯ï¼Œæ¯”å¦‚è¡Œæ•°ã€åˆ—æ•°ã€ç¼ºå¤±å€¼åˆ†å¸ƒã€‚è¿™å’Œdescribleæ˜¯ä¸åŒçš„ï¼Œåè€…æ˜¯æ˜¾ç¤ºæ•°å€¼åˆ†å¸ƒæƒ…å†µ



### 16ã€å¿«é€ŸæŸ¥çœ‹ç¼ºå¤±å€¼

```python
def display_missing(df):        
	for col in df.columns.tolist():                 
    print(f'{col} column missing values:{df[col].isnull().sum()}'
```

æˆ–è€…è¯´ï¼Œç›´æ¥ `data.isull().sum()`

### 17ã€ravelï¼ˆï¼‰

`data.ravelï¼ˆï¼‰` å¯ä»¥æŠŠæ•°ç»„å±•å¹³æˆä¸€ç»´æ•°ç»„ï¼Œä¾¿äºé€å…ƒç´ è®¡ç®—ã€‚



### 18ã€ç”»å›¾

plt.plotç”¨äºç»˜åˆ¶æŠ˜çº¿å›¾ï¼Œplt.scatterç”¨äºç»˜åˆ¶æ•£ç‚¹å›¾

```python
# æ°´å¹³æŸ±çŠ¶å›¾

def plot_mi_scores(scores):
    scores = scores.sort_values(ascending=True)
    width = np.arange(len(scores))
    ticks = list(scores.index)
    plt.barh(width, scores)
    plt.yticks(width, ticks)
    plt.title("Mutual Information Scores")


plt.figure(dpi=100, figsize=(8, 5))
plot_mi_scores(mi_scores)
```



### 19ã€predict_proba

model.predict_proba(data),å¯ä»¥é¢„æµ‹æ•°æ®çš„åˆ†ç±»æ¦‚ç‡



### 20ã€è§£å†³éçº¿æ€§é—®é¢˜

1. ä½¿ç”¨å¤šé¡¹å¼å›å½’`PolynomialFeatures`
2. ï¼ˆéçº¿æ€§æ ¸ï¼‰ï¼Œå³ç‰¹å¾æ˜ å°„åˆ°é«˜ç»´ç©ºé—´ï¼Œåœ¨é«˜ç»´ç©ºé—´çº¿æ€§å¯åˆ†ã€‚
3. ä½¿ç”¨å¯ä»¥ç›´æ¥å¤„ç†éçº¿æ€§é—®é¢˜çš„æ¨¡å‹



### 21ã€np.log1p å’Œ np.expm1

äºŒè€…äº’ä¸ºåå‡½æ•°.log1på®é™…ä¸Šä¸º`ln(1+x)`ï¼Œå¯ä»¥å¯¹0ä½¿ç”¨ï¼Œå¹¶ä¸”å¯¹å°æ•°å€¼çš„ç²¾ç¡®åº¦æ›´é«˜ã€‚



### 22ã€æ¿€æ´»ä¸ä¸¢å¼ƒ

å…ˆæ¿€æ´»åä¸¢å¼ƒã€‚æ¿€æ´»æ˜¯å¸¦æ¥éçº¿æ€§å˜åŒ–ï¼Œä¸¢å¼ƒå®é™…ä¸Šæ˜¯è®­ç»ƒæ—¶å±è”½æ¿€æ´»å€¼ï¼Œæµ‹è¯•æ—¶æ¢å¤ã€‚



### 23ã€apply

pandasæ•°æ®å¯ä»¥ä½¿ç”¨applyï¼Œå¯¹æ¯ä¸€åˆ—æˆ–è€…æ¯ä¸€è¡Œæ•°æ®åšå¤„ç†ï¼Œé»˜è®¤æ˜¯axis=0ï¼Œå¯¹åˆ—å¤„ç†ã€‚



### 24ã€mseå’Œrmse

- **MSEï¼ˆMean Squared Errorï¼‰**ï¼šå‡æ–¹è¯¯å·®

$\text{MSE} = \frac{1}{n} \sum_{i=1}^{n} (y_i - \hat{y}_i)^2$

- **RMSEï¼ˆRoot Mean Squared Errorï¼‰**ï¼šå‡æ–¹æ ¹è¯¯å·®,å¹¶ä¸”å•ä½å’Œyä¸€æ ·ï¼Œæ–¹ä¾¿è§£é‡Šã€‚

$RMSE= \sqrt{\text{MSE}} = \sqrt{\frac{1}{n} \sum_{i=1}^{n} (y_i - \hat{y}_i)^2}$



### 25ã€ è¿‡æ‹Ÿåˆä¸æ¬ æ‹Ÿåˆ

å½“æ•°æ®é‡å°‘ï¼Œå¹¶ä¸”å­˜åœ¨å™ªå£°æ—¶ï¼Œå°±ä¼šå‘ç”Ÿè¿‡æ‹Ÿåˆï¼Œæ­¤æ—¶æ¨¡å‹ä¸çŸ¥å­¦ä¹ åˆ°äº†æ•°æ®ç‰¹ç‚¹ã€‚ä¹Ÿå­¦åˆ°äº†å™ªå£°ã€‚æ¬ æ‹Ÿåˆå—é™äºæ¨¡å‹ç»“æ„ç­‰åŸå› ï¼Œå­¦ä¹ èƒ½åŠ›å·®ï¼Œè™½ç„¶æ•°æ®é‡å¤§ï¼Œå™ªå£°æ¯”è¾ƒå°ï¼Œä½†å­¦ä¹ çš„ç‰¹å¾å¹¶ä¸å…¨é¢ã€‚æˆ‘ä»¬å°±æ˜¯è¦åœ¨è¿‡æ‹Ÿåˆå’Œæ¬ æ‹Ÿåˆä¸­æ‰¾åˆ°ä¸€ç§å¹³è¡¡ã€‚

è®­ç»ƒè¯¯å·®å’Œæµ‹è¯•è¯¯å·®å·®è·å¾ˆå¤§æ—¶ï¼Œé€šå¸¸ä¼šè¿‡æ‹Ÿåˆã€‚æˆ‘ä»¬æƒ³æ‰¾åˆ°æœ€ä½³ç‚¹ï¼ˆ`Sweet Spot`ï¼‰ã€‚

æ¢ä¸€ç§è§’åº¦ï¼Œå½“æ•°æ®é‡å¾ˆå°æ—¶ï¼Œæ¨¡å‹å…³æ³¨çš„ç‰¹å¾ä¹Ÿå¾ˆå°‘ï¼Œå› æ­¤ä¼šè¿‡åº¦å­¦ä¹ ï¼Œå‘ç”Ÿè¿‡æ‹Ÿåˆã€‚

æ•°æ®é›†ä¸­å­˜åœ¨ä¸å¯çº¦å™ªå£°ï¼Œå³æ¨¡å‹æ— æ³•å­¦ä¹ çš„ç‰¹å¾ï¼Œå› ä¸ºå™ªå£°æœ¬èº«å°±æ˜¯éšæœºçš„ã€‚



### 26ã€ShuffleSplit

éšæœºäº¤å‰éªŒè¯å™¨



### 27ã€è¯„åˆ†æŒ‡æ ‡

è¿™æ˜¯ **scikit-learn çš„è®¾è®¡çº¦å®š**ï¼ŒåŸå› æ˜¯ **scikit-learn æ‰€æœ‰è¯„åˆ†æŒ‡æ ‡ï¼ˆscoringï¼‰éƒ½éµå¾ªâ€œåˆ†æ•°è¶Šå¤§è¶Šå¥½â€çš„ç»Ÿä¸€è§„åˆ™**ã€‚ä½†æ˜¯åƒ **MAEã€MSEã€RMSE è¿™ç±»è¯¯å·®æŒ‡æ ‡** æ˜¯ **â€œè¶Šå°è¶Šå¥½â€** çš„ï¼Œæ‰€ä»¥å¦‚æœç›´æ¥ç”¨æ­£å€¼ï¼Œæ¨¡å‹è¯„åˆ†ä¼šå’Œæ¡†æ¶çš„é€»è¾‘å†²çªã€‚

```python
scoring="neg_mean_absolute_error"
```

scikit-learn å®é™…åšçš„æ˜¯ï¼š

- å…ˆè®¡ç®— **`mean_absolute_error`**ï¼ˆæ­£çš„è¯¯å·®å€¼ï¼‰
- å†å– **è´Ÿå·**ï¼ˆä¹˜ä»¥ `-1`ï¼‰ï¼Œè¿”å›ä¸€ä¸ªâ€œè´Ÿçš„åˆ†æ•°â€ã€‚

è¿™æ ·ä¸€æ¥ï¼Œè¯¯å·®è¶Šå°ï¼Œè´Ÿæ•°çš„ç»å¯¹å€¼è¶Šå°ï¼Œä½†ç”±äºæ›´æ¥è¿‘ 0ï¼ˆæˆ–æ›´å¤§ï¼‰ï¼Œå°±èƒ½æ»¡è¶³â€œ**åˆ†æ•°è¶Šé«˜è¶Šå¥½**â€çš„æ¡†æ¶ç»Ÿä¸€è§„åˆ™ã€‚

| æŒ‡æ ‡ | `scoring` åç§°                | å–å€¼å«ä¹‰                        |
| ---- | ----------------------------- | ------------------------------- |
| MAE  | `neg_mean_absolute_error`     | è¿”å›è´Ÿçš„ MAEï¼Œè¶Šæ¥è¿‘ 0 è¯´æ˜è¶Šå¥½ |
| MSE  | `neg_mean_squared_error`      | è¿”å›è´Ÿçš„ MSE                    |
| RMSE | `neg_root_mean_squared_error` | è¿”å›è´Ÿçš„ RMSE                   |



### 28ã€æ˜¾ç¤ºæŸä¸€åˆ—æ•°æ®çš„åˆ†å¸ƒ

```
data.plot.hist(bins=10, edgecolor="black")

```

å°†æ•°æ®åˆ’åˆ†ä¸º 10 ä¸ªç­‰å®½åŒºé—´ï¼Œ`edgecolor` æ˜¯è¾¹æ¡†é¢œè‰²ã€‚



### 29ã€è¯¯å·®æŒ‡æ ‡

MAE ç»å¯¹è¯¯å·®

MSE ã€**RMSEï¼ˆå’Œæ•°æ®å•ä½ä¸€è‡´ï¼Œè§£é‡Šæ€§å¼ºï¼‰** ç›¸å¯¹è¯¯å·®



### 30ã€cross_val_score

å¯ä»¥å¿«é€Ÿè¯„ä¼°äº¤å‰éªŒè¯åˆ†æ•°ï¼Œè¿™ä¸€ç‚¹å’Œcross_validateå¾ˆç›¸ä¼¼ï¼Œåªä¸è¿‡åªå–äº†è¯„ä¼°åˆ†æ•°ã€‚å‚æ•°`scoring`å¯ä»¥é€‰æ‹©å¤šä¸ªè¯„ä¼°æŒ‡æ ‡ï¼Œå…¶ä¸­`balanced_accuracy`åˆ†åˆ«è®¡ç®—ä¸åŒç±»çš„å‡†ç¡®å€¼ï¼Œå†å¹³å‡ï¼Œå¯ä»¥æœ‰æ•ˆå¤„ç†ç±»åˆ«ä¸å¹³è¡¡çš„é—®é¢˜ã€`accuracy`ç›´æ¥è®¡ç®—å‡†ç¡®å€¼ï¼Œå¾ˆå¯èƒ½ä¼šå¿½ç•¥å°‘æ•°ç±»è€Œåå‘äºå¤šæ•°ç±»ã€‚



### 31ã€ä½¿ç”¨  KNeighborsClassifier

ä½¿ç”¨ä¹‹å‰ï¼Œå…ˆå¯¹æ•°æ®è¿›è¡Œæ ‡å‡†åŒ–ï¼Œä¿è¯å„ä¸ªç‰¹å¾çš„è´¡çŒ®åº¦ç›¸åŒã€‚



### 32ã€train_test_split

éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç»“æœçš„é¡ºåº

```python
x_train,x_val,y_train,y_val=train_test_split(train_data,target_data,random_state=42,shuffle=True)

```



### 33ã€ item  å’Œ  detach

`item `æŠŠåªå«æœ‰ä¸€ä¸ªæ ‡é‡çš„å¼ é‡è½¬æ¢æˆpythonçš„æ•°å€¼ç±»å‹ï¼ˆfloatæˆ–è€…intï¼‰ï¼Œä»–è¦æ±‚å¿…é¡»æ˜¯å•å€¼å¼ é‡æ‰èƒ½ä½¿ç”¨è¯¥æ–¹æ³•ï¼ŒåŒæ—¶ä¼šå‰¥å»æ¢¯åº¦ä¿¡æ¯ï¼Œå¤åˆ¶äº†ä¸€ä¸ªæ–°çš„å€¼å‡ºæ¥ã€‚

detachæ˜¯æŠŠå¼ é‡ä»è®¡ç®—å›¾ä¸­åˆ†ç¦»å‡ºæ¥ï¼Œå¾—åˆ°ä¸€ä¸ªæ–°å¼ é‡ï¼Œæ²¡æœ‰æ¢¯åº¦ä¿¡æ¯ï¼Œä½†ä¸ä¹‹å‰çš„å¼ é‡å…±äº«åŒä¸€ç‰‡å†…å­˜ä¿¡æ¯ã€‚å½“ä½ æƒ³å¯¹æ–°æ•°æ®å°±åœ°æ›´æ”¹æ—¶ï¼Œä¸ºäº†ä¸å½±å“åŸæœ‰çš„æ•°æ®ï¼Œä½¿ç”¨å¦‚ä¸‹æ–¹æ³•`data.detach().clone()`



### 34ã€np.arange

`np.arange()` ä¸ä¼šåŒ…å«ç»ˆç‚¹ï¼Œä½œç”¨ç±»ä¼¼äºrange



### 35ã€BCEWithLogitsLoss ï¼ˆäºŒåˆ†ç±»ä»»åŠ¡ï¼‰

å·¥ä½œåŸç†æ˜¯ï¼šå‡½æ•°å†…éƒ¨å…ˆè¿›è¡Œsigmoidï¼Œè½¬æ¢æˆæ¦‚ç‡ï¼ŒåŸå…ˆçš„å€¼è¶Šå¤§ï¼Œæ¦‚ç‡å°±è¶Šå¤§ï¼›æ•°å€¼è¶Šå°ï¼Œæ¦‚ç‡å°±è¶Šå°ã€‚ï¼ˆä¹‹å‰ä¸ºæ­£æ•°ï¼Œè¡¨ç¤ºé¢„æµ‹1çš„æ¦‚ç‡æ›´å¤§ï¼›ä¹‹å‰ä¸ºè´Ÿæ•°ï¼Œè¡¨ç¤ºé¢„æµ‹0çš„æ¦‚ç‡æ›´å¤§ã€‚æ€»ä¹‹ç»å¯¹å€¼è¶Šå¤§ï¼Œæ¨¡å‹è¶Šè‡ªä¿¡ï¼‰ã€‚

![image-20250831164845577](C:\Users\osquer\Desktop\typoraå›¾ç‰‡\image-20250831164845577.png)

ä¹‹åå†ç»è¿‡ BCEloss ï¼Œ$BCE(y,y^ã€)=âˆ’[ylogy^ã€+(1âˆ’y)log(1âˆ’y^ã€)]$ ï¼Œå…¶ä¸­y` ä¸ºè½¬æ¢æˆçš„æ¦‚ç‡ï¼Œç»“æœä¸ºæŸå¤±ï¼ˆæŸå¤±è¶Šå°ï¼Œè¶Šå¥½ï¼‰ã€‚



### 36ã€lossæ³¨æ„ç‚¹

```
loss(pred,y_true)
```

pytorchéœ€è¦é¢„æµ‹å€¼åœ¨å‰ï¼ŒæŸå¤±å€¼åœ¨åã€‚sklearnåˆ™éœ€è¦çœŸå®å€¼åœ¨å‰ï¼Œé¢„æµ‹å€¼åœ¨åã€‚



### 37ã€make_column_selector 

```python
from sklearn.compose import make_column_transformer
from sklearn.compose import make_column_selector as selector

preprocessor = make_column_transformer(
    (categorical_preprocessor, selector(dtype_include=object)),
    remainder="passthrough", # ä¿ç•™åŸå§‹ç‰¹å¾
)
```



### 38ã€æ ‘æ¨¡å‹ç‰¹ç‚¹

1. ä¸éœ€è¦ç¼©æ”¾ï¼Œå› ä¸ºæ ‘æ¨¡å‹çœ‹é¡ºåºå’Œé˜ˆå€¼
2. ç±»åˆ«å¯ä»¥é‡‡ç”¨ OrdinalEncoder ç¼–ç ï¼Œå¯ä»¥å‡å°‘ç‰¹å¾ç»´åº¦ï¼Œé˜²æ­¢æ¢¯åº¦çˆ†ç‚¸ã€‚



### 39ã€ç¡®å®šæ¨¡å‹æœ€ä½³è¶…å‚æ•°

1. å¯¹éæ•°å€¼åˆ—å¤„ç†ï¼Œè¿›è¡Œç¼–ç ï¼Œå¯ä»¥`OrdinalEncoder` ï¼Œ ä¹Ÿå¯ä»¥ `OneHoteEncoder` 
2. å»ºç«‹æ¨¡å‹
3. è®¾ç½®æœç´¢çš„å‚æ•°ï¼Œå¹¶è¿›è¡Œæœç´¢
4. æ‰¾åˆ°æœ€ä½³å‚æ•°ï¼Œä¹Ÿå¯ä»¥é€‰æ‹©æ˜¾ç¤ºæ‰€æœ‰å‚æ•°



### 40ã€renameï¼ˆé‡å‘½åï¼‰

```python
cv_results = cv_results.rename(shorten_param, axis=1)
```

shorten_paramä¸ºé‡å‘½åæ–¹æ³•



### 41ã€rsplitï¼ˆä»å³è¾¹å¼€å§‹åˆ†å‰²å­—ç¬¦ä¸²ï¼‰

```python
str.rsplit(sep=None, maxsplit=-1)

```

è¡¨ç¤ºä»å³è¾¹å¼€å§‹åˆ†å‰²å­—ç¬¦ä¸²ï¼Œsepä¸ºåˆ†éš”ç¬¦ï¼Œmaxsplitè¡¨ç¤ºåˆ†å‰²æ¬¡æ•°



### 42ã€åµŒå¥—äº¤å‰éªŒè¯

å…ˆè¿›è¡ŒCV ï¼ŒæŠŠæ•°æ®æ‹†åˆ†æˆå¤–å±‚è®­ç»ƒé›†å’Œæµ‹è¯•é›†ï¼›åè¿›è¡Œå†…å±‚CVï¼Œåœ¨å¤–å±‚è®­ç»ƒé›†ä¸Šåšè¶…å‚æ•°æœç´¢å’Œäº¤å‰éªŒè¯ï¼ˆæ­¤æ—¶å†…éƒ¨è‡ªåŠ¨åˆ’åˆ†è®­ç»ƒé›†å’ŒéªŒè¯é›†ï¼‰ï¼›ä¹‹åç”¨å¤–å±‚è®­ç»ƒé›†åšäºŒæ¬¡æ‹Ÿåˆï¼ˆæœ€ç»ˆè®­ç»ƒï¼‰ï¼Œå¾—åˆ°ä¸€ä¸ªæ¨¡å‹ï¼Œå¹¶å¯¹è¿™ä¸ªæ¨¡å‹è¿›è¡Œäº¤å‰éªŒè¯è¯„ä¼°ã€‚

<img src="https://inria.github.io/scikit-learn-mooc/_images/nested_cross_validation_diagram.png" alt="Nested cross-validationdiagram" style="zoom:50%;" />

### 43ã€RandomizedSearchCV

**`n_iter`** ä»£è¡¨äº†è¿­ä»£æ¬¡æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´ä»–ä¼šä»æ‰€æœ‰å‚æ•°ç»„åˆä¸­éšæœºé€‰æ‹©è¯¥æ¬¡ã€‚



### 44ã€np.logspace

è¯¥å‡½æ•°ä¼šç”Ÿæˆç­‰æ¯”æ•°åˆ—ï¼Œç”ŸæˆæŒ‡æ•°èŒƒå›´å†…çš„å‚æ•°å€¼ã€‚startä¸ºèµ·å§‹å€¼ï¼Œstopä¸ºç»“æŸå€¼ï¼Œnumä¸ºç”Ÿæˆçš„æ ·æœ¬æ•°é‡ï¼Œbaseä¸ºåº•æ•°ã€‚

```python
np.logspace(start, stop, num=50, base=10.0)

```



### 45ã€astype ï¼ˆå¼ºåˆ¶è½¬æ¢ç±»åˆ«ï¼‰

```python
data.astype("float")
data.astype(np.float)
```

astypeå¼ºåˆ¶è½¬æ¢æ—¶ï¼Œä¼šå‘é›¶å–æ•´ï¼Œåˆ é™¤å°æ•°éƒ¨åˆ†ï¼Œå¹¶ä¸”æ›´æ¨èç¬¬äºŒç§å†™æ³•ï¼Œä¼¼ä¹ç¬¬ä¸€ç§npå†…éƒ¨ä¼šæ”¹å˜ç±»å‹ï¼ˆå°½ç®¡äºŒè€…èµ·åˆ°çš„ä½œç”¨éƒ½æ˜¯ç›¸åŒçš„ï¼‰ï¼Ÿ



### 46ã€cv

cvæ˜¯äº¤å‰éªŒè¯çš„æ–¹å¼ï¼Œsklearnå†…éƒ¨ä¼šè‡ªåŠ¨å¯¹æ•°æ®å’Œå¯¹åº”çš„æ ‡ç­¾åšç›¸åŒçš„åˆ’åˆ†ã€‚



### 47ã€pandas ç‰¹æ€§

1. å¯¹ pandas æ•°æ®èµ‹äºˆä¸€ä¸ªä¹‹å‰ä¸å­˜åœ¨çš„åˆ—åï¼Œpandaså°±ä¼šè‡ªåŠ¨åˆ›å»ºè¯¥åˆ—ã€‚

2. pandasæ•°æ®çš„columnså±æ€§ä¼šè¿”å›åˆ—åï¼Œä½†æ˜¯å®ƒæœ¬èº«ä»ç„¶æ˜¯pandasæ•°æ®ï¼ˆseriesï¼‰ï¼Œè¿™ç‚¹éå¸¸é‡è¦ã€‚



### 48ã€balanced_accuracy

å½“ä¸åŒç±»åˆ«çš„æ•°ç›®ä¸å¹³è¡¡æ—¶ï¼Œæ¨èè¿™ä¸ªscoringå‚æ•°ã€‚



### 49ã€sort_values()

å¯¹äºpandasæ•°æ®è€Œè¨€ï¼Œå¯ä»¥ä»¥æŸä¸€åˆ—ä¸ºä¾æ®ï¼Œå¯¹æ•´ä¸ªæ•°æ®è¿›è¡Œé‡æ–°æ’åºã€‚ascendingè¡¨ç¤ºå‡åºã€‚

```python
cv_results.sort_values(by="test_score",ascending=False)

```



### 50ã€list(x:str)

å­—ç¬¦ä¸²å¼ºåˆ¶è½¬æ¢ä¸ºåˆ—è¡¨æ—¶ï¼Œå­—ç¬¦ä¸²çš„æ¯ä¸€ä¸ªå­—ç¬¦éƒ½ä¼šè¢«æ‹†åˆ†å¼€ï¼Œè§†ä¸ºå•ç‹¬çš„å•å…ƒã€‚



### 51ã€reset_index

è¯¥å‡½æ•°ä¼šé‡æ–°æ’åˆ—æ•°æ®çš„ç´¢å¼•ï¼Œé€šè¿‡ dropå‚æ•°å¯ä»¥é€‰æ‹©æŠŠä¹‹å‰çš„ç´¢å¼•ä¸¢å¼ƒï¼Œinplaceå‚æ•°å¯ä»¥é€‰æ‹©å°±åœ°æ›´æ”¹ã€‚

```python
cv_results.reset_index(drop=True,inplace=True)
```



### 52ã€ç¡¬é¢„æµ‹å’Œè½¯é¢„æµ‹

predictï¼šç¡¬é¢„æµ‹ï¼ˆç›´æ¥é¢„æµ‹ç±»æˆ–è€…å€¼ï¼‰

predict_proba : è½¯é¢„æµ‹ï¼ˆé¢„æµ‹æ¯ä¸ªç±»çš„æ¦‚ç‡ï¼‰



### 53ã€==çº¿æ€§æ¨¡å‹çš„å‚æ•°==

coef_  ä»£è¡¨æ–œç‡ï¼Œæ˜¯ä¸€ä¸ª==ä¸€ç»´æ•°ç»„==

intercept_ä»£è¡¨æˆªè·ï¼Œæ˜¯ä¸€ä¸ª==æ•°å­—==



### 54ã€sklearnæ•°æ®ç‰¹å¾

sklearnæ•°æ®åº”è¯¥æ˜¯ `(n_samples,n_features)` çš„äºŒç»´ç‰¹å¾ã€‚



### 55ã€np.concatenate

np.concatenate ç”¨äºæ‹¼æ¥æ•°æ®ï¼Œè€Œpd.concatä¹Ÿç”¨äºæ‹¼æ¥æ•°æ®ï¼Œä¸è¦ææ··äº†ã€‚



### 56ã€Nystroem 

`Nystroem` å¯ä»¥æŠŠåŸå§‹ç‰¹å¾æ˜ å°„åˆ°é«˜ç»´ç©ºé—´ï¼Œå¹¶ä¸”å¯ä»¥è‡ªå·±è®¾å®šé«˜ç»´ç©ºé—´çš„ç»´åº¦` n_components` ï¼Œä»è€Œå¯ä»¥æ§åˆ¶ç‰¹å¾æ•°é‡ã€‚å¤§ä½“è¿‡ç¨‹æ˜¯é€‰å–ä¸€äº›æ•°æ®ä½œä¸ºåŸºç‚¹ï¼Œç„¶åè®¡ç®—å…¶ä»–æ•°æ®ä¸è¿™äº›åŸºç‚¹ä¹‹é—´çš„ç›¸ä¼¼åº¦ï¼Œå½’ä¸€åŒ–ä¹‹åï¼Œè®¡ç®—ç‰¹å¾çŸ©é˜µã€‚ä½†æ˜¯è¿™äº›ç‰¹å¾çš„è§£é‡Šæ€§ä¸å¦‚ `PolynomialFeatures` è§£é‡Šæ€§å¼ºã€‚

é»˜è®¤çš„ kernel æ˜¯ â€œrbfâ€ï¼ˆé«˜æ–¯å¾„å‘åŸºï¼‰æ ¸ï¼Œå®ƒå¯ä»¥æŠŠæ•°æ®æ˜ å°„åˆ°æ— é™ç©ºé—´ï¼Œè®©æ¨¡å‹ä¹Ÿå¯ä»¥è§£å†³éçº¿æ€§é—®é¢˜ã€‚å…¶ä¸­ï¼Œè¿˜æœ‰ä¸€ä¸ªå‚æ•°gammaï¼Œå…¶æ§åˆ¶ç€æ ¸å‡½æ•°çš„â€å¹³æ»‘åº¦â€œï¼Œå½“gammaå¤§æ—¶ï¼Œä¸¤ä¸ªç‚¹ç¨å¾®è¿œä¸€ç‚¹å°±ä¼šè¢«è§†ä¸ºä¸ç›¸å…³ï¼Œå½“gammaå°æ—¶ï¼Œå³ä½¿ä¸¤ä¸ªç‚¹ç›¸è·å¾ˆè¿œä¹Ÿä¼šè¢«è§†ä¸ºç›¸å…³ã€‚ï¼ˆæ ¸å‡½æ•°ç»“æœè¶‹å‘äº1è¡¨ç¤ºç›¸å…³ï¼Œè¶‹å‘äº0è¡¨ç¤ºæ— å…³ï¼‰ã€‚



### 57ã€ValidationCurveDisplay

æœ‰ä¸€äº›çŸ¥è¯†ç‚¹ï¼š

1. å‚æ•°scoringè¡¨æ˜è¯„ä¼°æŒ‡æ ‡
2. å‚æ•°score_name è¡¨æ˜å›¾ä¾‹ä¸Šçš„åå­—
3. negate_scoreè¡¨æ˜ç»˜å›¾æˆ–æ˜¾ç¤ºçš„æ—¶å€™å–è´Ÿå·ã€‚
4. æ–¹æ³• `from_estimator()` å¯ä»¥ç›´æ¥æŠŠæ¨¡å‹ä½œä¸ºå‚æ•°ï¼Œçœå»äº†`validation_curve()å‡½æ•°`çš„æ­¥éª¤ã€‚



### 58ã€ListedColormapï¼ˆè‡ªå®šä¹‰é¢œè‰²æ˜ å°„ï¼‰

```python
import matplotlib.pyplot as plt
import numpy as np
from matplotlib.colors import ListedColormap

X = np.random.rand(10,2)
y = np.array([0,1,0,1,0,1,0,1,0,1])

cmap = ListedColormap(["tab:red", "tab:blue"])
plt.scatter(X[:,0], X[:,1], c=y, cmap=cmap, s=100)
plt.show()

```



### 59ã€å­å›¾

plt.subplot()åˆ†åˆ«åˆ›å»ºå­å›¾ï¼Œæ¯æ¬¡è°ƒç”¨éƒ½ä¼šåˆ‡æ¢ä¸€ä¸ªå­å›¾ï¼Œè¿”å›å½“å‰å­å›¾å¯¹è±¡ã€‚

plt.subplots()ä¸€æ¬¡æ€§åˆ›å»ºå­å›¾ï¼Œè¿”å›ç”»å¸ƒå’Œæ‰€æœ‰å­å›¾å¯¹è±¡ã€‚



### 60ã€é€»è¾‘å›å½’

è¯¥æ¨¡å‹æ˜¯çº¿æ€§æ¨¡å‹ï¼Œç›´æ¥å­¦ä¹ æ•°æ®åˆ†å¸ƒï¼Œå¯èƒ½å­¦ä¸åˆ°çœŸå®çš„è§„å¾‹ï¼Œè¿™æ—¶å€™å¯ä»¥å…ˆå¯¹æ•°æ®å¤„ç†ï¼Œä½¿å…¶ç¦»æ•£åŒ–ï¼Œä¹‹åå†å­¦ä¹ å°±å¥½å¤šäº†ã€‚



### 61ã€KBinsDiscretizer

ç®±çº¿å›¾ï¼Œåªæ˜¯ä¸€ç§ç‰¹å¾å˜åŒ–ï¼Œæ— æ³•æ•æ‰åˆ°ç‰¹å¾ä¹‹é—´çš„äº¤äº’å…³ç³»ï¼Œï¼ˆSplineTransformerä¹Ÿæ˜¯å¦‚æ­¤ï¼‰



### 62ã€==transformer ï¼ˆç»å…¸æœºå™¨å­¦ä¹ ï¼‰åˆè°ˆ==

é€šè¿‡åˆ©ç”¨éçº¿æ€§ç‰¹å¾å·¥ç¨‹ï¼Œå¯ä»¥ä½¿ç”¨é€»è¾‘å›å½’ç­‰çº¿æ€§æ¨¡å‹å¯¹æ•°æ®é›†åˆ†ç±»ã€‚`KBinsDiscretizer` å’Œ `SplineTransformer` ç­‰ Transformer å¯ç”¨äºä¸ºæ¯ä¸ªåŸå§‹ç‰¹å¾ç‹¬ç«‹è®¾è®¡éçº¿æ€§ç‰¹å¾ã€‚è¿™äº›è½¬æ¢å™¨åªèƒ½å¯¹æŸäº›ç‰¹å¾ä½œç¼–ç å¤„ç†å°†è¿ç»­å€¼è½¬æ¢æˆæ˜“äºå­¦ä¹ çš„ç¦»æ•£å€¼ï¼Œä½†æ˜¯å´æ— æ³•æ•è·åŸå§‹ç‰¹å¾ä¹‹é—´çš„ç›¸äº’ä½œç”¨ã€‚	

`PolynomialFeatures` å’Œ `Nystroem ç­‰ Transformer` å¯ç”¨äºè®¾è®¡æ•è·åŸå§‹ç‰¹å¾ä¹‹é—´ç›¸äº’ä½œç”¨çš„éçº¿æ€§ç‰¹å¾ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¾€å¾€å¯ä»¥æŠŠäºŒè€…ç»“åˆèµ·æ¥ï¼Œå¯¹æ•°å€¼è¦ç´ åº”ç”¨åˆ†ç®±æˆ–æ ·æ¡å˜æ¢ä»¥åŠå¯¹åˆ†ç±»ç‰¹å¾åº”ç”¨å•çƒ­ç¼–ç å¯èƒ½ä¼šå¾ˆæœ‰ç”¨ã€‚ç„¶åï¼Œå¯ä»¥å°†ç”Ÿæˆçš„ç‰¹å¾ä¸æ ¸è¿‘ä¼¼ï¼ˆå¤§å¤§å‡å°è®¡ç®—é‡ï¼‰ç›¸ç»“åˆï¼Œä»¥æ¨¡æ‹Ÿæ•°å€¼å’Œåˆ†ç±»ç‰¹å¾ä¹‹é—´çš„äº¤äº’ä½œç”¨ã€‚è¿™å¯ä»¥åœ¨ `ColumnTransformer` çš„å¸®åŠ©ä¸‹å®ç°ã€‚



### 63ã€çº¿æ€§å¯åˆ†ç¦»

å­˜åœ¨ä¸€æ¡ç›´çº¿æˆ–è€…ä¸€ä¸ªå¹³é¢å¯ä»¥æŠŠä¸¤ä¸ªç±»å®Œå…¨åˆ†å¼€ã€‚



### 64ã€çº¿æ€§æ¨¡å‹

çº¿æ€§å›å½’ä¼˜å…ˆä½¿ç”¨å²­å›å½’ï¼Œ**alpha**ä»£è¡¨æ­£åˆ™åŒ–å¼ºåº¦ï¼Œalphaè¶Šå¤§è¡¨ç¤ºæ­£åˆ™åŒ–åŠ›åº¦è¶Šå¤§ã€‚çº¿æ€§æ¨¡å‹å€¾å‘äºç»™å°æ•°å€¼ç‰¹å¾åˆ†é…å¤§æƒé‡ï¼Œå¤§æ•°å€¼ç‰¹å¾åˆ†é…å°æƒé‡ã€‚è€Œå²­å›å½’åˆ™ä¼šæ­£åˆ™åŒ–å¤§æƒé‡ï¼Œå‡å°å…¶æƒé‡ï¼Œå‡ºç°â€œè¿‡åº¦æƒ©ç½šâ€ã€‚



### 65ã€æ•°æ®ç¼©æ”¾

`MinMaxScaler`ä¼šå°†æ•°æ®ç¼©æ”¾åˆ°æŒ‡å®šèŒƒå›´ï¼Œé»˜è®¤æ˜¯1ï¼Œé€šå¸¸å¹¶ä¸ä¼šæ”¹å˜æ•°æ®çš„åŸæœ‰åˆ†å¸ƒæƒ…å†µï¼Œåªæ˜¯ä¼šç¼©å°æ•°å€¼èŒƒå›´ï¼Œå¯¹å¼‚å¸¸å€¼éå¸¸æ•æ„Ÿã€`Standscaler`ä¼šå°†æ•°æ®è¿›è¡Œæ ‡å‡†åŒ–ï¼Œå‡å€¼ä¸º0ï¼Œæ–¹å·®ä¸º1ï¼Œæ•°æ®å¤§å¤šé›†ä¸­åœ¨-3ä¸3ä¹‹é—´ã€‚

1. æŠ€å·§ï¼š`MinMaxScaler`åè·Ÿ`PolynomialFeatures` å¥½å¤„æ˜¯ä¼šæŠŠæ•°æ®ç¼©æ”¾01ä¹‹é—´ï¼Œå³ä½¿ç‰¹å¾äº¤äº’ï¼Œæ•°æ®èŒƒå›´ä»åœ¨01ä¹‹é—´ï¼Œåé¢è·Ÿä¸Š`Radge`çš„è¯ï¼Œå¯¹æ¯ä¸ªç‰¹å¾æ›´å…¬å¹³ã€‚è€Œæ ‡å‡†åŒ–çš„ç¼ºç‚¹æ˜¯ï¼Œç‰¹å¾äº¤äº’æ—¶ï¼Œå¯èƒ½ä¼šå‡ºç°ä¸åŒç‰¹å¾èŒƒå›´ä¸åŒï¼Œç›¸å½“äºæ²¡æœ‰æ ‡å‡†åŒ–ã€‚



### 66ã€RidgeCV

å†…ç½®äº¤å‰éªŒè¯çš„å²­å›å½’ï¼Œä¼šè‡ªåŠ¨æ‰¾åˆ°ç»™å®šèŒƒå›´å†…çš„æœ€ä¼˜alphaï¼Œå…¶ä¸­store_cv_resultsä¸ºTrueæ—¶ï¼Œä¼šæŠŠæ¯ä¸ªalphaå¯¹åº”çš„äº¤å‰éªŒè¯å€¼å­˜å‚¨åœ¨cv_results_ä¸­ã€‚



### 67ã€aggregate(["mean", "std"])

```python
cv_alphas = cv_alphas.aggregate(["mean", "std"])
```

aggregateè¡¨ç¤ºå¯¹æ•°æ®åº”ç”¨è¿™ä¸¤ä¸ªå‡½æ•°ï¼Œæ²¿ç€è¡Œå¢å¤§çš„æ–¹å‘ã€‚



### 68ã€é€»è¾‘å›å½’ä¸­çš„æƒ©ç½šé¡¹ C

å¯¹äºé€»è¾‘å›å½’è€Œè¨€ï¼ŒCè¶Šå°æ„å‘³ç€æƒ©ç½šè¶Šä¸¥é‡ï¼Œè¿™å°±ä½¿å¾—ä¸ºäº†ä¿è¯æŸå¤±å°ï¼Œæ‰€ä»¥æ¨¡å‹çš„æƒé‡å°±ä¼šè¾ƒå°ï¼Œè€Œzå°±ä¼šè·Ÿç€å°ï¼Œä¹‹åç»è¿‡sigmoidä¹‹åï¼Œæ¦‚ç‡åœ¨0.5å·¦å³ï¼Œæ¨¡å‹ç½®ä¿¡åº¦ä½ï¼Œæ‰€ä»¥æ¨¡å‹ä¸æ•¢ç¡®å®šç±»åˆ«ã€‚
$$
z=wTx+b
$$

$$
\text{Loss}(w) = \frac{1}{n} \sum_{i=1}^{n} \log\Big(1 + e^{-y_i (w^T x_i + b)}\Big) + \frac{1}{2C} \|w\|_2^2
$$

å¹¶ä¸”ï¼Œå¦‚æœåŸæœ¬çš„ç‰¹å¾å°±è¶³ä»¥è¿›è¡Œçº¿æ€§åˆ†ç¦»ï¼Œæ•ˆæœä¹Ÿä¸é”™ã€‚é‚£å°±æ²¡æœ‰å¿…è¦å¢åŠ ç‰¹å¾ç»´åº¦ï¼ˆå¤æ‚æ€§ï¼‰ï¼Œå› ä¸ºéšç€ç‰¹å¾ç»´åº¦çš„å¢åŠ ï¼Œæ¨¡å‹å¾ˆå®¹æ˜“è¿‡æ‹Ÿåˆã€‚



### 69ã€ç®±çº¿å›¾

data.box_plot()ç»˜åˆ¶ç®±çº¿å›¾ï¼Œå‚æ•°vert=Trueï¼Œç”¨äºè°ƒèŠ‚æ¨ªçºµåæ ‡æ˜¾ç¤ºæ¬¡åºã€‚

plt.tight_layout()ç”¨äºè‡ªåŠ¨è°ƒèŠ‚æ ‡ç­¾ä½ç½®ç­‰ï¼Œå¯ä»¥é»˜è®¤åŠ ä¸Š



### 70ã€OnehotEncoder

å½“æˆ‘ä»¬åˆ’åˆ†æµ‹è¯•é›†å’Œè®­ç»ƒé›†çš„æ—¶å€™ï¼Œæœ‰æ—¶å€™ä¸€äº›ç‰¹å¾ä¸­çš„ç±»åˆ«åªåœ¨æŸä¸ªæ•°æ®é›†ä¸Šå‡ºç°ï¼Œè¿™æ—¶å€™å°±ä¼šæŠ¥é”™ï¼Œæ‰€ä»¥æˆ‘ä»¬æœ€å¥½è®¾ç½®å‚æ•° handle_unknown="ignore"



### 71ã€å˜æ¢å™¨

é€šå¸¸å˜æ¢å™¨ä¼šç”Ÿæˆ  numpy  æ•°ç»„ã€‚



### 72ã€RandomResizedCropï¼ˆè£å‰ªå›¾åƒï¼‰

```python
transforms.RandomResizedCrop(32,scale=(0.62,1.0),
                            ratio=(1.0,1.0))
```

å‚æ•°æœ€å¥½æ˜¯æµ®ç‚¹æ•°ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ32æ˜¯å˜æ¢ä¹‹åçš„å›¾åƒçš„é•¿å’Œå®½ï¼Œå³ä½¿ç»è¿‡scaleä¹‹åçš„å›¾åƒé¢ç§¯ä¸ç¬¦è¦æ±‚ï¼Œå›¾åƒä¹Ÿä¼šè¢«ç¼©æ”¾åˆ°32çš„ï¼Œè¿™ç‚¹æ”¾å¿ƒã€‚



### 73ã€å¼ é‡æ‹¼æ¥

å¼ é‡æ‹¼æ¥æœ‰ä¸¤ç§ç­–ç•¥ï¼Œä¸€ç§æ˜¯torch.catï¼Œè¿™ç§æ–¹å¼ï¼Œä¸ä¼šå¢åŠ ç»´åº¦ï¼Œæ²¿æ‹¼æ¥ç»´åº¦é•¿åº¦å¢åŠ ã€‚å¦ä¸€ç§æ˜¯torch.stackï¼Œè¿™ç§æ–¹å¼ä¼šå¢åŠ ç»´åº¦ï¼Œæ–°å¢çš„ç»´åº¦å°±æ˜¯æ‹¼æ¥ç»´ã€‚å¯è§£å†³å½¢çŠ¶å¦‚`list[tensor]`çš„æ•°æ®ã€‚äºŒè€…åœ¨æ‹¼æ¥ä¸€ç»´æ•°æ®æˆ–è€…äºŒç»´æ•°æ®ï¼ˆä½†å®é™…ä¸Šæ˜¯ä¸€ç»´æ•°æ®ï¼‰æ—¶ä½“ç°ä¸å‡ºå·®å¼‚ï¼Œä½†æ˜¯æ‹¼æ¥å¤šç»´æ•°æ®æ—¶å°±ä½“ç°å‡ºæ¥äº†ã€‚ç›´ç™½ç‚¹è®²ï¼Œcatæ˜¯ä½ æƒ³çš„é‚£ç§æ–¹å¼ï¼Œä¸€è¡Œæ’åˆ—ä¸€è¡Œï¼Œstackåˆ™æ˜¯ä¸€å¨å †åœ¨ä¸€å¨ä¸ŠğŸ˜‚ã€‚

ä½†è¦è®°ä½ï¼Œnumpyä¸­æ˜¯concatenateã€‚



### 74ã€æŸå¤±ï¼ˆtorchï¼‰

é»˜è®¤å‚æ•°reduction="mean"ï¼Œä¹Ÿå°±æ˜¯è¯´è®¡ç®—è¿™ä¸€æ‰¹æ•°æ®çš„æŸå¤±å¹³å‡å€¼ã€‚



### 75ã€argmax

`torch.argmax(data)`é»˜è®¤ä¼šæŠŠæ•°æ®å±•å¹³åæ‰¾åˆ°æœ€å¤§å€¼



### 76ã€sum

å¼ é‡æ•°æ®æ±‚å’Œï¼Œç›´æ¥`data.sum()`å³å¯ï¼Œè¿™æ ·è¿”å›çš„ä»ç„¶æ˜¯ä¸€ä¸ªå¼ é‡ï¼Œå¹¶ä¸”è®¡ç®—æ•ˆç‡é«˜ï¼›ç›¸åï¼Œå¦‚æœé‡‡ç”¨`sum(data)`,è¯¥æ–¹å¼æ˜¯åˆ©ç”¨pyå†…ç½®çš„sumå‡½æ•°ã€‚å®ƒä¼šæŠŠæ•°æ®è§†ä¸ºå¯è¿­ä»£å¯¹è±¡æ¥å¤„ç†ï¼Œæ•ˆç‡ä½ã€‚

â€‹	

### 77ã€item

å½“æˆ‘ä»¬æƒ³åœ¨å¼ é‡è®¡ç®—åå¾—åˆ°ä¸€ä¸ªæ•°å€¼æ—¶ï¼Œä½¿ç”¨`data.item()`çš„æ–¹æ³•ï¼Œå› ä¸ºå¼ é‡è®¡ç®—çš„ç»“æœä»ç„¶æ˜¯å¼ é‡ï¼Œå³ä½¿ä»–æ˜¯å•å€¼å¼ é‡ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±éœ€è¦æŠŠä»–è½¬æ¢æˆæ•°å€¼ã€‚



### 78ã€å…ƒç»„

```python
self.x=x,
```

å®é™…ä¸Šï¼Œä¼šæŠŠxè§†ä¸ºä¸€ä¸ªå…ƒç»„ï¼Œå› æ­¤åˆ‡è®°ä¸è¦å†æ•°æ®åé¢åŠ ä¸Šé€—å·ã€‚



### 79ã€è§†è§‰æ¨¡å‹

```
Conv â†’ BatchNorm â†’ ReLU
```



### 80ã€GAPï¼ˆå…¨å±€å¹³å‡æ± åŒ–ï¼‰

æœ¬è´¨ä¸ŠæŠŠæ¯ä¸ªé€šé“çœ‹ä½œä¸€ä¸ªç‰¹å¾ï¼Œæ±‚å–è¯¥é€šé“é‡Œé¢çš„å¹³å‡å€¼ã€‚



### 81ã€å·ç§¯

ç ”ç©¶å‘ç°å°‘é‡â€œè·¨å±‚éçº¿æ€§â€ä¸ä¼šç«‹å³å¯¼è‡´é€€åŒ–ï¼Œåè€Œå¯èƒ½æ›´å¥½è®­ç»ƒï¼ˆè¿™åœ¨ ResNet/Bottleneck ç»“æ„é‡Œæ¯”è¾ƒå¸¸è§ï¼‰ã€‚**å·ç§¯å †å å¿…é¡»å‘¨æœŸæ€§æ’å…¥éçº¿æ€§ï¼Œå¦åˆ™ç½‘ç»œé€€åŒ–ä¸ºçº¿æ€§æ¨¡å‹**ã€‚



### 82ã€æ¿€æ´»å‡½æ•°

```
nn.ReLU(inplace=True)
```

è¯¥å‡½æ•°å†…éƒ¨å­˜åœ¨ inplace å‚æ•°ï¼Œè¡¨ç¤ºå¼ é‡æ˜¯å¦å°±åœ°æ›´æ”¹ã€‚å°±åœ°å°ç›–ä¸ä¼šäº§ç”Ÿæ–°å¼ é‡ï¼ŒèŠ‚çœå†…å­˜ï¼ˆç‰¹åˆ«æ˜¯åœ¨è®¡ç®—èµ„æºç´§å¼ çš„è®¾å¤‡ä¸Šï¼‰ã€‚



### 83ã€torchvision.io.read_image

è¯¥å‡½æ•°è¯»å–çš„ç»“æœæ˜¯å¼ é‡



### 84ã€æ ‡ç­¾ï¼ˆtorchï¼‰

å¯¹äºtorchæ¥è®²ï¼Œä»–åº”è¯¥æ˜¯ä¸ªlongç±»å‹



### 85ã€LabelEncoder

è¯¥å‡½æ•°ç”¨äºå•åˆ—æ•°æ®å¤„ç†ï¼Œä¸ºç¦»æ•£å€¼åˆ†é…æ ‡ç­¾ï¼ˆä»é›¶å¼€å§‹ï¼‰ï¼Œè¿”å›ä¸€ä¸ª1d ndarray



### 86ã€arrayå’Œndarray



arrayæ˜¯å¹¿æ³›çš„æ¦‚å¿µï¼Œé€šå¸¸æŒ‡æ•°ç»„å’Œåˆ—è¡¨ç»“æ„ï¼Œnp.ndarray()æ˜¯npçš„æ ¸å¿ƒæ•°æ®ç»“æ„ã€‚np.array()å®é™…ä¸Šè°ƒç”¨çš„æ˜¯np.ndarray()



### 87ã€ToPILImage

transforms.ToPILImageå¯ä»¥æŠŠå¼ é‡è½¬æ¢ä¸ºå›¾åƒï¼ˆè¾“å…¥å¼ é‡è¦æ±‚åœ¨ï¼ˆ0 ~255ï¼‰æˆ–è€…ï¼ˆ0 ~1ï¼‰ï¼‰



### 88ã€listdirï¼ˆï¼‰

è¯¥å‡½æ•°å¯ä»¥åˆ—ä¸¾å‡ºæŸæ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶åï¼Œä½†æ³¨æ„å®ƒå¹¶ä¸æ˜¯æŒ‰åå­—é¡ºåºå»è¯»å–ï¼Œå› æ­¤æœ€å¥½æœ€å¤–å±‚åŠ ä¸Šsortedå‡½æ•°å¹¶è®¾ç½®å‚æ•°keyï¼Œç¡®ä¿æ–‡ä»¶æ’åˆ—é¡ºåºæ­£å¸¸ã€‚



### 89ã€å­¦ä¹ ç‡è°ƒåº¦å™¨ï¼ˆç²¾ç®€ç‰ˆï¼‰

 `StepLR `ä¼šæ¯éš”å‡ ä¸ªæ­¥é•¿å°†å­¦ä¹ ç‡ä¹˜ä¸Šä¸€ä¸ªè¡°å‡å› å­ gammaï¼Œé€šå¸¸æ˜¯0.1æˆ–è€…0.5ã€‚é€‚åˆæ•°æ®é›†æ¯”è¾ƒå°ï¼Œæ¨¡å‹ç»“æ„æ¯”è¾ƒç®€å•çš„åœºæ™¯ï¼Œéœ€è¦è‡ªå·±æ ¹æ®ç»˜åˆ¶çš„å›¾åƒè®¾ç½®æ­¥é•¿ step_sizeï¼ˆæœ€å¥½ä¸€å¼€å§‹ä¸åŠ ï¼Œå…ˆè®­ç»ƒä¸€ä¸‹è§†æƒ…å†µå†åŠ ï¼‰ã€‚

```python
scheduler = torch.optim.lr_scheduler.StepLR(optimizer, step_size=10, gamma=0.1)
```

` MultiStepLR` åœ¨æŒ‡å®šçš„ epochï¼ˆmilestonesï¼‰å¤„å°†å­¦ä¹ ç‡ä¹˜ä»¥ gammaã€‚

```
scheduler = torch.optim.lr_scheduler.MultiStepLR(optimizer, milestones=[10, 20], gamma=0.1)
```

`ReduceLROnPlateau` ä¼šåœ¨æŒ‡æ ‡åœæ­¢æ”¹å–„æ—¶ï¼Œå°†å­¦ä¹ ç‡ä¹˜ä¸Š gammaã€‚è¿™ç§è°ƒåº¦å™¨å¯ä»¥æ ¹æ®æ¨¡å‹æ€§èƒ½åŠ¨æ€é™ä½å­¦ä¹ ç‡ï¼Œé€‚åˆå¤æ‚ä»»åŠ¡

- modeï¼šç›‘æ§æŒ‡æ ‡çš„æ¨¡å¼ï¼ˆmin è¡¨ç¤ºæŸå¤±ï¼Œmax è¡¨ç¤ºå‡†ç¡®ç‡ï¼‰ã€‚
- factorï¼šè¡°å‡å› å­ï¼ˆç±»ä¼¼ gammaï¼‰ã€‚
- patienceï¼šç­‰å¾…æŒ‡æ ‡æœªæ”¹å–„çš„ epoch æ•°ã€‚

```
scheduler = torch.optim.lr_scheduler.ReduceLROnPlateau(optimizer, mode='min', factor=0.1, patience=5)

```

**åŠ¨æ€è°ƒæ•´**ï¼šæ ¹æ®æ¨¡å‹æ€§èƒ½ï¼ˆå¦‚éªŒè¯æŸå¤±æˆ–å‡†ç¡®ç‡ï¼‰åŠ¨æ€é™ä½å­¦ä¹ ç‡ï¼Œé€‚åˆå¤æ‚ä»»åŠ¡æˆ–è¿ç§»å­¦ä¹ ã€‚

- **æ‚¨çš„ CIFAR-10 ä»»åŠ¡**ï¼šå¼ºçƒˆæ¨èï¼Œå› ä¸ºé¢„è®­ç»ƒ ResNet-18 éœ€è¦ä½å­¦ä¹ ç‡ï¼ˆ3e-4ï¼‰ï¼Œä¸” CIFAR-10 è®­ç»ƒå¯èƒ½é‡åˆ°æŸå¤±æ³¢åŠ¨ï¼ŒReduceLROnPlateau å¯æ ¹æ®æŸå¤±åŠ¨æ€è°ƒæ•´ã€‚
- **ä¸ç¨³å®šè®­ç»ƒ**ï¼šå½“æŸå¤±æˆ–å‡†ç¡®ç‡åœ¨æŸäº› epoch åœæ»æ—¶ï¼Œè‡ªåŠ¨é™ä½å­¦ä¹ ç‡ã€‚

- **æ³¨æ„**ï¼šéœ€æä¾›éªŒè¯æŸå¤±æˆ–å‡†ç¡®ç‡ï¼Œè®¡ç®—å¼€é”€ç•¥é«˜ã€‚



### 90ã€Dataloaderç‰¹æ€§

Dataloaderä¼šè¿”å›ä¸€ä¸ªå…ƒç»„ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦è¿›è¡Œè§£åŒ…ï¼Œå¸¸è§çš„æ“ä½œå¦‚ä¸‹

```
for (batch,) in dataloader:
```



### 91ã€DecisionBoundaryDisplay (ç»˜åˆ¶å†³ç­–è¾¹ç•Œ)

```python
import matplotlib.pyplot as plt
import matplotlib as mpl

from sklearn.inspection import DecisionBoundaryDisplay

tab10_norm = mpl.colors.Normalize(vmin=-0.5, vmax=8.5)
# create a palette to be used in the scatterplot
dbd = DecisionBoundaryDisplay.from_estimator(
    linear_model,
    data_train,
    response_method="predict",
    cmap="tab10",
    norm=tab10_norm,
    alpha=0.5,
)
```

from_estimatoræ–¹æ³•å®é™…ä¸Šæ˜¯ä»æ¨¡å‹å»ºç«‹å†³ç­–è¾¹ç•Œã€‚data_trainæ˜¯è®­ç»ƒæ•°æ®ï¼Œä¹Ÿå°±æ˜¯å†³ç­–è¾¹ç•Œç”Ÿæˆçš„ä¾æ®ã€‚cmapæ˜¯é¢œè‰²æ˜ å°„ï¼Œâ€œtab10â€æ˜¯ä¸€ç§é¢œè‰²æ˜ å°„æ–¹æ¡ˆã€‚response_methodè¡¨æ˜å‡½æ•°ä»¥å“ªç§æ–¹å¼æ¥ç»˜åˆ¶å†³ç­–è¾¹ç•Œï¼Œä¸€èˆ¬æœ‰predictï¼ˆæ˜¾ç¤ºç±»åˆ«ï¼Œç¦»æ•£ï¼‰ï¼Œpredict_proba(è¿ç»­ï¼Œæ¸å˜ï¼Œæ˜¾ç¤ºæ¦‚ç‡)ã€‚normè¡¨æ˜ä¸åŒç±»åˆ«çš„åˆ†é…æƒ…å†µï¼Œvminå’Œvmaxè¡¨æ˜äº†æŸç±»åˆ«åˆ’åˆ†çš„é¢œè‰²æ˜ å°„çš„åŒºé—´ï¼Œæ¯”å¦‚,-0.5~0.5ä¸ºä¸€ç§é¢œè‰²ï¼Œæ­£å¥½å¯¹åº”äº†ç±»åˆ«0ï¼Œä¹‹åä¼šåœ¨cmapé‡Œé¢æ‰¾åˆ°å¯¹åº”å¯¹çš„é¢œè‰²æ˜ å°„ï¼Œå®Œæˆé¢œè‰²åˆ†é…ã€‚



### 92ã€ç»˜åˆ¶ç¦»æ•£ç‚¹ï¼ˆsnsï¼‰

```python
sns.scatterplot(
    data=penguins,
    x=culmen_columns[0],
    y=culmen_columns[1],
    hue=target_column,
    palette=palette,
)

```

snsçš„é£æ ¼æ˜¯ä¼ å…¥pdæ•°æ®å’Œä¸¤ä¸ªåˆ—åï¼ˆå­—ç¬¦ä¸²ï¼‰ï¼Œhueæ˜¯é¢œè‰²ç¼–ç çš„ä¾æ®ï¼Œä¹Ÿå°±æ˜¯è¯´å‡½æ•°ä¼šæ ¹æ®æ¯ä¸ªæ•°æ®çš„ç±»åˆ«ä¸åŒåˆ†é…ä¸åŒçš„é¢œè‰²ï¼Œpaletteæ˜¯é¢œè‰²æ˜ å°„è¡¨ã€‚

å…¶ä¸­ï¼Œcolorå‚æ•°æ˜¯ç»Ÿä¸€è®¾ç½®æ‰€æœ‰ç‚¹çš„é¢œè‰²ï¼Œpaletteåªæœ‰åœ¨hueå‚æ•°å­˜åœ¨çš„å‰æä¸‹ä½¿ç”¨ï¼Œè¡¨ç¤ºå¯¹æ¯ä¸ªç±»è¿›è¡Œåˆ†åˆ«æ˜ å°„ã€‚

è¯¥å‡½æ•°åªæ¥å—xå’Œyä½œä¸ºæ•°æ®è¾“å…¥ï¼Œå³ä½¿ä¸æ˜¯pdæ•°æ®ä¹Ÿè¦å†™ä¸Šè¿™ä¸¤ä¸ªå‚æ•°ï¼Œå¹¶ä¸”åªèƒ½æ˜¯ä¸€ç»´æ•°æ®ã€‚

å‚æ•°linewidthå¯ä»¥æ§åˆ¶æ•£ç‚¹è¾¹æ¡†çº¿çš„ç²—ç»†ã€‚

facecolorså‚æ•°æ§åˆ¶å¡«å……é¢œè‰²ï¼Œå½“å€¼ä¸ºâ€œnoneâ€æ—¶ï¼Œå†…éƒ¨æ— å¡«å……ã€‚

å‚æ•°markerç”¨äºæŒ‡å®šæ•£ç‚¹å›¾ä¸­ç‚¹çš„å½¢çŠ¶

### 93ã€å›¾åƒæ ‡ç­¾

```python

plt.legend(bbox_to_anchor=(1.05, 1), loc="upper left")
_ = plt.title("Decision boundary using a logistic regression")
```

bbox_to_anchorè¡¨æ˜å›¾ä¾‹å¯¹é½çš„ç‚¹åœ¨1.05å€çš„é•¿å’Œå®½å¤„ï¼ˆè¯´ç™½äº†å°±æ˜¯åæ ‡ä½ç½®ç‚¹ï¼‰ï¼Œlocè¡¨æ˜å¯¹é½çš„ä½ç½®æ˜¯å›¾ä¾‹çš„å·¦ä¸Šæ–¹ç‚¹ã€‚



### 94ã€å‚æ•°æ¨¡å‹å’Œéå‚æ•°æ¨¡å‹

å‚æ•°æ¨¡å‹æ˜¯æŒ‡æ¨¡å‹çš„å­¦ä¹ å‚æ•°æ˜¯å›ºå®šçš„ï¼Œéå‚æ•°æ¨¡å‹æ˜¯æŒ‡æ¨¡å‹ä¸ä¾èµ–å›ºå®šæ•°é‡çš„å‚æ•°æ¥æ‹Ÿåˆæ¨¡å‹ï¼Œä¼šæ ¹æ®å¯»æ¥ä½ æ•°æ®é‡çš„å¤šå°‘å»è°ƒæ•´æ¨¡å‹å¤æ‚åº¦ã€‚



### 95ã€æ ‘æ¨¡å‹çš„å¯è§†åŒ–

ä½ è¦çŸ¥é“æ ‘æ¨¡å‹åœ¨æ‹Ÿåˆåï¼Œä»–çš„åˆ’åˆ†è§„åˆ™å®é™…ä¸Šå·²ç»ç¡®å®šäº†ï¼Œå› æ­¤æˆ‘ä»¬æ—¢å¯ä»¥ä½¿ç”¨å†³ç­–è¾¹ç•Œå±•ç¤ºå‡½æ•°ï¼Œä¹Ÿå¯ä»¥é‡‡ç”¨æ›´è¯¦ç»†çš„tree_plotå‡½æ•°ã€‚å…¶ä¸­ï¼Œå‚æ•°feature_namesè¡¨ç¤ºæ•°æ®ç‰¹å¾ï¼ˆåº”è¯¥ä¸è®­ç»ƒæ•°æ®çš„ç‰¹å¾ä¿æŒä¸€è‡´ï¼‰ï¼Œclass_namesè¡¨ç¤ºå¶å­èŠ‚ç‚¹çš„åç§°ï¼Œä¸€èˆ¬å°±æ˜¯    class_names=tree.classes_.tolist(),å› ä¸ºtree.classes _ ä¼šè¿”å›ä¸€ä¸ªndarrayçš„æ•°æ®ï¼Œå› æ­¤éœ€è¦æŠŠä»–è½¬æ¢æˆåˆ—è¡¨æ‰è¡Œã€‚inpurityåˆ™è¡¨ç¤ºå’‹æ‚è´¨ï¼Œä¹Ÿå°±æ˜¯è¡¨æ˜åˆ’åˆ†çš„å¥½ä¸å¥½ã€‚

```python
from sklearn.tree import plot_tree
_,ax=plt.subplots(figsize=(8,6))
_=plot_tree(
    tree,
    feature_names=culmen_columns,
    class_names=tree.classes_.tolist(),
    impurity=False,
    ax=ax
)
```



### 96ã€å†³ç­–æ ‘åˆ†ç±»å™¨

è¯¥åˆ†ç±»å™¨åœ¨ä¾æ®æŸä¸ªç‰¹å¾åˆ’åˆ†ä¹‹åï¼Œä¼šé¢„æµ‹åˆ†åŒºä¸­è¡¨ç¤ºæœ€å¤šçš„ç±»ã€‚



### 97ã€æ–°å»ºæ•°æ®ï¼ˆpdï¼‰

æ–°å»ºæ•°æ®çš„æ—¶å€™æœ€å¥½ä½¿ç”¨pd.Dateframeï¼Œç›´æ¥æˆä¸ºè§„èŒƒå³å¯ï¼Œæ²¡æœ‰ç†ç”±ã€‚



### 98ã€pdæ•°æ®ç‰¹æ€§

data[[column]]å¾—åˆ°dataframeæ•°æ®ï¼ˆäºŒç»´ï¼‰ï¼Œdata[column]å¾—åˆ°ä¸€ç»´æ•°æ®



### 99ã€è®­ç»ƒä¸é¢„æµ‹ï¼ˆsklearnï¼‰

åŠ å…¥è®­ç»ƒçš„å•¥æ—¶å€™ä½¿ç”¨çš„pdæ•°æ®ï¼Œé‚£ä¹ˆé¢„æµ‹çš„æ—¶å€™ä¹Ÿåº”è¯¥ä½¿ç”¨pdæ•°æ®ï¼Œå¹¶ä¸”é¢„æµ‹ç‰¹å¾åå­—åº”è¯¥å’Œè®­ç»ƒç‰¹å¾åå­—ç›¸åŒã€‚



### 100ã€ç»˜å›¾é¢œè‰²

```
'tab:blue', 'tab:orange', 'tab:green', 'tab:red', 'tab:purple', 'tab:brown', 'tab:pink', 'tab:gray', 'tab:olive', 'tab:cyan'


```



### 101ã€å†³ç­–æ ‘çš„è¶…å‚æ•°

`max_depth` ä¼šåœ¨ç‰¹å®šæ°´å¹³ä¸Šæ°´å¹³åˆ‡å‰²æ ‘ï¼Œæ— è®ºæ ‘ç”Ÿé•¿æ˜¯å¦æœ‰åˆ©ã€‚



### 102ã€%%time

åœ¨jupyterçš„å•å…ƒæ ¼å†…è¿è¡Œï¼Œå¯ä»¥æ˜¾ç¤ºå•å…ƒæ ¼çš„è¿è¡Œæ—¶é—´ã€‚



### 103ã€bagging

åŸºç¡€æ¨¡å‹è¶Šæ¥è¿‘çœŸå®æ•°æ®ç”Ÿæˆè¿‡ç¨‹ï¼Œé¢„æµ‹ç»“æœå°±è¶Šç²¾ç¡®ã€‚Baggingä¸»è¦é™ä½æ–¹å·®ï¼Œå¹¶ä¸é™ä½åå·®ï¼Œä½“ç°äº†Bootstrapçš„ç†å¿µï¼ˆå³æœ‰æ”¾å›æŠ½æ ·ï¼Œè¿™æ ·çš„è¯å¤§æ¦‚æœ‰63.2%çš„æ•°æ®ä¼šè¢«è‡³å°‘é€‰ä¸­ä¸€æ¬¡ï¼Œå‰©ä¸‹çš„æ•°æ®ä¸ä¼šè¢«é€‰ä¸­ï¼‰



### 104ã€cv_resultsï¼ˆæœç´¢æ—¥å¿—ï¼‰

å¯¹äºæœç´¢è¶…å‚æ•°çš„cvæ–¹æ³•ï¼Œä¼šæœ‰ä¸€ä¸ªå±æ€§å«åš cv_results_ï¼Œé‡Œé¢è®°å½•ç€æœ¬æ¬¡æœç´¢çš„è¶…å‚æ•°ä»¥åŠæ¨¡å‹è¯„ä¼°æŒ‡æ ‡ï¼Œè¿è¡Œæ—¶é—´ã€‚å¹¶ä¸”ï¼Œæœç´¢çš„è¶…å‚æ•°ï¼Œæ¯”å¦‚ max_depth åœ¨å‰é¢åŠ ä¸Šparam _ï¼Œå°±å˜æˆäº†param_max_depthã€‚



### 105ã€baggingä¸éšæœºæ£®æ—

baggingå’Œéšæœºæ£®æ—éƒ½ä¼šé‡‡ç”¨bootstrapéšæœºå–æ ·ï¼Œä½†ä¸åŒçš„æ˜¯baggingåªä¼šè¿›è¡Œä¸€æ¬¡ç‰¹å¾é‡‡æ ·ï¼Œè€Œéšæœºæ£®æ—åˆ™ä¼šå¤šæ¬¡ç‰¹å¾é‡‡æ ·ï¼ˆå­èŠ‚ç‚¹åˆ†è£‚æ—¶ï¼‰ã€‚



### 106ã€ç¼–ç 

OneHotEncoderç¼–ç æ ¼å¼å¤„ç†æœªçŸ¥æ•°æ®æ—¶ï¼Œéœ€è¦é‡‡ç”¨ handle_unknown="ignore"çš„æ–¹æ³•ã€‚å¯¹äºOrdinalEncoderç¼–ç å¤„ç†æœªçŸ¥æ ¼å¼æ•°æ®æ—¶ï¼Œéœ€è¦é‡‡ç”¨handle_unknown="use_encoded_value", unknown_value=-1



### 107ã€make_column_transformer

ä¼šé’ˆå¯¹ä¸åŒçš„åˆ—é‡‡æ ·ä¸åŒçš„å¤„ç†æ–¹æ³•ï¼Œä½†éœ€è¦æ³¨æ„çš„æ˜¯å‚æ•°remainderï¼Œé»˜è®¤æ˜¯"drop"ï¼Œä¹Ÿå°±æ˜¯ä¼šä¸¢å¼ƒæ²¡æœ‰æŒ‡å®šå¤„ç†çš„åˆ—ï¼Œæˆ–è€…æˆ‘ä»¬å¯ä»¥ä¸»åŠ¨è®¾ç½®å‚æ•°"passthrough"ï¼Œè¿™æ ·å°±ç›´æ¥ä¿ç•™åŸæ•°æ®ï¼ˆä¹Ÿå°±æ˜¯æœªä½œå¤„ç†çš„æ•°æ®ï¼‰ã€‚



### 108ã€ç¼–ç æ ¼å¼å¯¹æ¯”

`OneHotEncoder` é€‚åˆç±»åˆ«æ•°è¾ƒå°‘ï¼Œé€‚åˆçº¿æ€§æ¨¡å‹æˆ–è€…è·ç¦»åº¦é‡æ¨¡å‹ï¼Œå› ä¸ºè¿™ç±»æ¨¡å‹å¯¹æ•°å€¼å¤§å°æ•æ„Ÿï¼Œå¦‚æœé‡‡ç”¨`OrdinalEncoder`çš„è¯ï¼Œå¯èƒ½ä¼šå­¦åˆ°ç³Ÿç³•çš„ç±»åˆ«å¤§å°å…³ç³»ï¼Œè¿™æ˜¯ä¸åˆç†çš„ã€‚æ­¤å¤–ï¼Œå…ˆåšç‹¬çƒ­ç¼–ç ï¼Œååº§ç‰¹å¾äº¤å‰ï¼ˆ`POlyNormialFeatures`ï¼‰ï¼Œå¯ä»¥æ„é€ å‡ºæœ‰ç”¨çš„ç‰¹å¾

`OrdinalEncoder` ä¼šæŠŠç‰¹å¾è¿›è¡Œæ•´æ•°ç¼–ç ï¼Œå¯ä»¥å¯¹å¤šåˆ—è¿›è¡Œå¤„ç†ï¼Œé€‚åˆæ ‘æ¨¡å‹ï¼Œå› ä¸ºè¿™ç±»æ¨¡å‹èƒ½æ›´å¥½çš„è¿›è¡Œåˆ†å‰ï¼ˆæ¯”å¦‚å¤§äºæˆ–è€…å°äºæŸä¸ªé˜ˆå€¼ï¼‰ã€‚

`LabelEncoder` å…¶å®å’Œ`OrdinalEncoder`å¾ˆåƒï¼Œä¹Ÿæ˜¯æ•´æ•°ç¼–ç ï¼Œä¸åŒçš„æ˜¯ï¼Œä»–åªèƒ½å¯¹ä¸€åˆ—æ•°æ®è¿›è¡Œç¼–ç ï¼Œä½†å¥½åœ¨å®ƒçš„è¿”å›ç»“æœæ˜¯ ndarray çš„æ•°æ®ï¼Œæ–¹ä¾¿è¿›è¡Œåç»­è½¬æ¢ã€‚



### 109ã€é›†æˆæ¨¡å‹

RandomForestClassifier ä¸­max_featureså‚æ•°é»˜è®¤é‡‡ç”¨äº†â€œsqrtâ€ç­–ç•¥ï¼Œä¹Ÿå°±æ˜¯è¯´æ¨¡å‹ä¼šè‡ªåŠ¨æŠŠmax_featuresè®¾ç½®ä¸ºè¾“å…¥æ•°æ®ç‰¹å¾æ•°çš„æ ¹å·äºŒå€ã€‚è€Œå…¶ä»–æ¨¡å‹åˆ™ä¼šç¦æ­¢ç‰¹å¾å­é‡‡æ ·ï¼Œä¹Ÿå°±æ˜¯ä¼šé‡‡ç”¨å…¨éƒ¨ç‰¹å¾å»å›å½’æˆ–è€…åˆ†ç±»ã€‚



### 110ã€nonzeroã€flatnonzero

äºŒè€…éƒ½æ˜¯è¿”å›éé›¶å€¼çš„ç´¢å¼•ï¼Œä½†æ˜¯åˆæœ‰ä¸€äº›å·®åˆ«ã€‚å…¶ä¸­ nonzero æ˜¯æŒ‰ç…§åŸæ•°æ®å½¢çŠ¶è¿”å›ç»“æœï¼Œè€Œflatnonzeroåˆ™æ˜¯å…ˆæŠŠåŸæ•°æ®å±•å¹³åï¼Œå†è¿”å›ç»“æœã€‚



### 111ã€np.intersect1d

è¯¥å‡½æ•°ä¼šè¿”å›ä¸¤ä¸ªæ•°ç»„çš„äº¤é›†



### 112ã€AdaBoostï¼ˆboostingï¼‰

boostingä¸baggingä¸åŒï¼šåœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä»ä¸é‡æ–°é‡‡æ ·æˆ‘ä»¬çš„æ•°æ®é›†ï¼Œæˆ‘ä»¬åªæ˜¯ä¸ºåŸå§‹æ•°æ®é›†åˆ†é…ä¸åŒçš„æƒé‡ã€‚

å‚æ•°n_estimatorsï¼Œboostæ˜¯è¯´æ¯æ¬¡æ‹Ÿåˆéƒ½æ˜¯åŒæ ·çš„è®­ç»ƒæ•°æ®ï¼Œç„¶åæ‰¾å‡ºæ¯æ¬¡æ‹Ÿåˆé”™è¯¯çš„æ•°æ®ï¼Œå¹¶ç»™ä»–ä»¬åˆ†é…è¾ƒé«˜çš„æƒé‡ï¼Œä½¿å¾—æ¨¡å‹æ›´æ³¨æ„ä»–ä»¬ï¼Œé‡å¤æ“ä½œï¼Œä¹Ÿå°±æ˜¯è¯´n-estimatorså‚æ•°å°±æ˜¯è¿™ä¸ªé‡å¤æ“ä½œçš„æ¬¡æ•°ã€‚æœ€ç»ˆæ‹Ÿåˆçš„æ¨¡å‹æœ‰å±æ€§estimator_weights _è¡¨ç¤ºæœ€ç»ˆæ¨¡å‹çš„æƒé‡ï¼Œestimator_errors _ è¡¨ç¤ºå¼±å­¦ä¹ å™¨åœ¨è®­ç»ƒé›†ä¸Šçš„åŠ æƒé”™è¯¯ç‡ï¼Œæ¨¡å‹å°±æ˜¯æ ¹æ®è¯¥å±æ€§ä¸ºä¸åŒå¼±å­¦ä¹ å™¨åˆ†é…æœ€ç»ˆæƒé‡çš„ã€‚



### 113ã€GBDTï¼ˆæ¢¯åº¦æå‡å†³ç­–æ ‘ï¼‰ï¼ˆboostingï¼‰

å…¨å`Gradient Boosting Decision Trees`

å³ä½¿ AdaBoost å’Œ GBDT éƒ½æ˜¯æå‡ç®—æ³•ï¼Œå®ƒä»¬çš„æ€§è´¨ä¹Ÿä¸åŒï¼šå‰è€…ä¸ºç‰¹å®šæ ·æœ¬åˆ†é…æƒé‡ï¼Œè€Œ GBDT å°†è¿ç»­å†³ç­–æ ‘æ‹Ÿåˆåˆ°å…¶å‰ä¸€æ ‘çš„æ®‹å·®ï¼ˆå› æ­¤ç§°ä¸ºâ€œæ¢¯åº¦â€ï¼‰ã€‚å› æ­¤ï¼Œé›†æˆä¸­çš„æ¯æ£µæ–°æ ‘éƒ½è¯•å›¾é€šè¿‡ä¸“é—¨è§£å†³å‰ä¸€ä¸ªå­¦ä¹ å™¨æ‰€çŠ¯çš„é”™è¯¯æ¥å®Œå–„å…¶é¢„æµ‹ï¼Œè€Œä¸æ˜¯ç›´æ¥é¢„æµ‹ç›®æ ‡ã€‚ä¹Ÿå°±æ˜¯è¯´ä¸Šä¸€é¢—æ ‘çš„æ®‹å·®ä¼šè¢«å½“ä½œæ ‡ç­¾ï¼Œç”¨äºé¢„æµ‹æ–°çš„ç»™å®šæ•°æ®çš„æ®‹å·®ï¼Œé‚£ä¹ˆæœ€ç»ˆé¢„æµ‹å‡ºæ¥çš„ä¹Ÿå°±æ˜¯ä¸Šä¸€é¢—æ ‘é¢„æµ‹çš„å·®è·ï¼ŒäºŒè€…ç›¸åŠ æˆ–è€…è¯´åŠ æƒå°±èƒ½é€æ­¥é€¼è¿‘åŸå§‹æ•°æ®åˆ†å¸ƒ.



### 114ã€ax.set_xlim

```python
ax.set_xlim([x_min,x_max])
```

è®¾ç½®åæ ‡è½´ä»x_minåˆ°x_max,ä¸åœ¨è¯¥èŒƒå›´çš„æ›²çº¿å°†è¢«éšè—ã€‚



### 115ã€baggingå’Œboosting

baggingæ˜¯å¼ºå­¦ä¹ å™¨ï¼Œä¹Ÿå°±æ˜¯è¯´å­æ¨¡å‹éœ€è¦è¿‡æ‹Ÿåˆï¼Œè€Œboostingæ˜¯å¼±å­¦ä¹ å™¨ï¼Œå­æ¨¡å‹é€šå¸¸ä¼šæ¬ æ‹Ÿåˆã€‚

è¶…å‚æ•°è°ƒæ•´æŠ€å·§ï¼Œå¦‚ä¸‹ï¼š

1. **bagging** ã€‚éšæœºæ£®æ—æœ‰å‚æ•° n_estimators è¡¨ç¤ºå­æ ‘çš„æ•°é‡ï¼Œæ•°ç›®è¶Šå¤šæ³›åŒ–æ€§èƒ½è¶Šå¥½ï¼Œä½†æ˜¯ä¼šå‡æ…¢æ‹Ÿåˆæ—¶é—´ã€‚å‚æ•°  max_features  ä¼šæ§åˆ¶åœ¨ç”Ÿé•¿æ ‘æ—¶å¯»æ‰¾æœ€ä½³æ‹†åˆ†æ—¶éœ€è¦è€ƒè™‘çš„ç‰¹å¾å¤§å°ï¼Œè¾ƒå°çš„å€¼åˆ™éœ€è¦è¿›è¡Œæ›´å¤šçš„å­æ ‘ä»¥è¾¾åˆ°åŒæ ·çš„æ•ˆæœï¼Œå¦‚æœè®¾ç½®ä¸ºnoneç­‰åŒäºä¼šè€ƒè™‘æ‰€æœ‰çš„ç‰¹å¾ã€‚max_depthé™åˆ¶äº†å­æ ‘çš„æœ€å¤§æ·±åº¦ã€‚å‚æ•°max_leaf_nodesæ§åˆ¶æœ€å¤šæœ‰å¤šå°‘ä¸ªå¶å­ã€‚å‚æ•°min_samples_leafæ§åˆ¶æ¯ä¸ªå¶å­æœ€å°‘æœ‰å¤šå°‘ä¸ªæ ·æœ¬ï¼Œä½†æ˜¯å¤ªå¤§çš„å€¼åè€Œä¼šå½±å“æ€§èƒ½ã€‚

2. **boosting**ã€‚ç›´æ–¹å›¾æ¢¯åº¦æå‡æ ‘ï¼Œå‚æ•° max_depthæ§åˆ¶æ¯æ£µæ ‘çš„æœ€å¤§æ·±åº¦ï¼Œè¡¨ç¤ºæ¯æ£µæ ‘æ‹Ÿåˆç¨‹åº¦å¤§å°ï¼Œä¸€èˆ¬è¾ƒå°ï¼ˆæ¯•ç«Ÿæ˜¯å¼±å­¦ä¹ å™¨ï¼‰ã€‚learning_rateæ§åˆ¶æ¯æ¬¡çŸ«æ­£çš„è´¡çŒ®ç¨‹åº¦ã€‚max_iterè¡¨æ˜æ ‘çš„æ•°ç›®ï¼Œä¹Ÿå°±æ˜¯è¿­ä»£çš„æ¬¡æ•°ï¼Œä½†æ˜¯ä»–ä¼šæ”¶åˆ°æ—©åœçš„å½±å“ï¼Œä¸€èˆ¬è¾ƒå¤§ï¼Œå¹¶ä¸”learning_rateè¾ƒå°ï¼ŒäºŒè€…ç›¸äº’é…åˆï¼Œè¾¾åˆ°ä¸é”™çš„ç¨‹åº¦ã€‚

3. åŸºæœ¬å¤„ç†ç­–ç•¥

   1. **å¿«é€Ÿ baseline** â†’ `RandomForestRegressor`

      1. ç¨³å®šï¼Œä¸å®¹æ˜“å‡ºé”™ï¼Œå°‘è°ƒå‚å°±èƒ½è·‘ã€‚

   2. **ä¸­ç­‰æ•°æ®é›†**ï¼ˆ1k~100k æ ·æœ¬ï¼‰ â†’ `GradientBoostingRegressor`

      ç²¾åº¦æ¯”éšæœºæ£®æ—é«˜ï¼Œå¯è°ƒ `n_estimators` + `learning_rate`ã€‚

   3. **å¤§æ•°æ®é›†** (>100k æ ·æœ¬) â†’ `HistGradientBoostingRegressor`

      å¿«é€Ÿé«˜æ•ˆï¼Œå¯ä½¿ç”¨æ—©åœï¼ˆ`early_stopping=True`ï¼‰ã€‚

4. **ç‰¹åˆ«ä»»åŠ¡**ï¼ˆç‰¹å¾ç¨€ç–/å¼‚å¸¸æ ·æœ¬å¤šï¼‰ â†’ å¯ä»¥å°è¯• AdaBoost æˆ–è€… XGBoost/LightGBMã€‚

------

4ï¸âƒ£ ç«èµ›å®ç”¨ç­–ç•¥

- **å…ˆç”¨éšæœºæ£®æ—**ï¼šå¿«é€Ÿ baselineï¼Œçœ‹æ•°æ®ç‰¹æ€§ã€‚
- **å†ç”¨  GBDT**ï¼šæå‡ç²¾åº¦ï¼Œå¯è°ƒå­¦ä¹ ç‡+æ ‘æ·±åº¦ã€‚
- **å¯åŠ å †å **ï¼ˆstackingï¼‰ï¼šæœ€ç»ˆèåˆå¤šä¸ªæ¨¡å‹ï¼Œå°¤å…¶æ˜¯ RF + GBDT + LightGBMï¼Œé€šå¸¸èƒ½è¿›ä¸€æ­¥æå‡ 1-2%ã€‚

### 116ã€KBinsDiscretizer (åˆ†ç®±ç¦»æ•£åŒ–å™¨)

å°†è¿ç»­æ•°æ®ç¦»æ•£åŒ–åˆ°ç‰¹å®šåŒºé—´ï¼ˆæ ¹æ®å€¼çš„èŒƒå›´åˆ’åˆ†åŒºé—´ï¼Œå¹¶æŠŠåŒä¸€åŒºé—´çš„æ•°å€¼è§†ä¸ºä¸€ç±»ï¼‰ï¼Œä½ è¦è®°ä½å®ƒä¸ä¼šå¿½ç•¥æœ¬å°±ç¦»æ•£çš„ç‰¹å¾ï¼Œå› æ­¤ï¼Œæœ€å¥½ä½¿ç”¨ columntransformerã€‚è¯¥æ–¹æ³•å¯ä»¥åŠ é€Ÿæ¢¯åº¦æå‡ï¼Œå› ä¸ºåˆ†ç®±ä¼šå‡å°‘å€™é€‰åˆ†å‰²ç‚¹ï¼Œä¹Ÿå°±æ˜¯è¯´æ¨¡å‹åœ¨å­èŠ‚ç‚¹åˆ†è£‚æ—¶ä¸ºæœç´¢æœ€ä¼˜åˆ’åˆ†ç‚¹çš„æ—¶é—´å°±æ˜æ˜¾å°‘äº†ï¼ˆäº‹å®ä¸ŠHistGradientBoostingClassifierå’ŒHistGradientBoostingRegressorå·²ç»åšäº†è¯¥æ­¥éª¤ï¼‰ã€‚



### 117ã€negateå‚æ•°

åœ¨éªŒè¯æ›²çº¿æ˜¾ç¤ºæ—¶ï¼Œæ¯”å¦‚  ValidationCurveDIsplay  å‡½æ•°ï¼Œé‡Œé¢æœ‰å‚æ•°negateï¼Œå½“è®¾ç½®ä¸ºTrueæ—¶ï¼Œåˆ™ä¼šè‡ªåŠ¨æŠŠè¯„ä¼°åˆ†æ•°å–åï¼Œå¸¸ç”¨äºè¯„ä¼°æŒ‡æ ‡ä¸ºæŸå¤±æ—¶ã€‚



### 118ã€HistGradientBoostingï¼ˆåˆ†ç±»å™¨æˆ–è€…å›å½’å™¨ï¼‰

åŸç”Ÿæ”¯æŒç¼ºå¤±å€¼æ•°æ®ï¼Œä¼šè‡ªåŠ¨æ ¹æ®æ½œåœ¨æ”¶ç›Šè¿›è¡Œåˆ†é…ï¼Œè€Œå…¶ä»–çš„æ ‘åˆ™å¤„ç†ä¸äº†ç¼ºå¤±å€¼ã€‚



### 119ã€é¢„æµ‹å› å­

é€šå¸¸æ˜¯æŒ‡æ•°æ®ç‰¹å¾ã€‚



### 120ã€åµŒå¥—äº¤å‰éªŒè¯

å†…å±‚å’Œå¤–å±‚çš„è¯„ä¼°æŒ‡æ ‡å¯ä»¥ç›¸åŒä¹Ÿå¯ä»¥ä¸åŒï¼Œå› ä¸ºå†…å±‚çš„scoringç”¨äºé€‰å–å‚æ•°æ—¶çš„æä¾›æ ‡å‡†ï¼Œå¤–å±‚çš„scoringç”¨äºäº¤å‰éªŒè¯è¯„ä¼°æ¨¡å‹çš„æ€§èƒ½ã€‚å¹¶ä¸”ä½ è¦æ³¨æ„çš„æ˜¯äº¤å‰éªŒè¯è¿”å›çš„ç»“æœæ˜¯ä¸€ä¸ªå­—å…¸ï¼Œä¸€èˆ¬ä½ éœ€è¦æŠŠå®ƒè½¬æ¢æˆpdæ•°æ®ã€‚



### 121ã€å¿«é€Ÿåˆ é™¤ç¼ºå¤±å€¼

```python
dataset = dataset[feature_names + [target_name]].dropna(axis="rows", how="any")
```



### 122ã€sampleï¼ˆéšæœºæŠ½å–æ•°æ®ï¼‰

```python
dataset = dataset.sample(frac=1,random_state=0).reset_index(drop=True)
```

sampleè¡¨ç¤ºéšæœºæŠ½å–æ•°æ®ï¼Œfracè¡¨ç¤ºæŠ½å–æ•°æ®å çš„æ¯”ä¾‹ï¼Œreset_indexä¼šé‡ç½®ç´¢å¼•ã€‚



### 133ã€å‚æ•°n_estimators å’Œå‚æ•°max_iter

å‰è€…æ˜¯éšæœºæ£®æ—å’Œæ¢¯åº¦æå‡çš„å­æ ‘æ•°ç›®ï¼Œåè€…æ˜¯ç›´æ–¹å›¾æ¢¯åº¦æå‡çš„å­æ ‘æ•°ç›®ã€‚



### 134ã€è¯„ä¼°æŒ‡æ ‡

sklearnéƒ½æ˜¯ï¼ˆy_true,y_predï¼‰ï¼Œå¯¹äºpytrochï¼Œå†…ç½®çš„è¯„ä¼°æŒ‡æ ‡æ˜¯ï¼ˆy_pred,y_tryeï¼‰ï¼Œæ­¤å¤–ä¹Ÿå¯ä»¥è‡ªå®šä¹‰è¯„ä¼°æŒ‡æ ‡ã€‚



### 135ã€dropæ–¹æ³•

å¯¹äºpandasæ•°æ®è€Œè¨€å­˜åœ¨dropæ–¹æ³•ï¼Œæœ‰å‚æ•°labelså¯ä»¥ç›´æ¥æŒ‡å®šè¦åˆ é™¤çš„è¡Œåˆ—åå­—ï¼Œaxiså‚æ•°è¡¨æ˜åˆ é™¤çš„æ˜¯è¡Œè¿˜æ˜¯åˆ—ï¼Œcolumnså¯ä»¥æ¥å—å¤šä¸ªåˆ—åï¼Œä½†å¿…é¡»æ˜¯åˆ—è¡¨çš„å½¢å¼ï¼Œindexå¯ä»¥æ¥å—å¤šä¸ªè¡Œåï¼Œä¹Ÿå¿…é¡»æ˜¯åˆ—è¡¨çš„å½¢å¼ã€‚



### 136ã€npæ•°æ®å’Œtorchæ•°æ®

torch.tensor(data)ä¼šæ‹·è´æ•°æ®ï¼Œä¸ä¼šå…±äº«å†…å­˜ï¼Œæ›´å®‰å…¨ï¼Œæ¥å—deviceï¼Œdtypeç­‰å‚æ•°ã€‚

torch.from_numpy(data)ä¼šé›¶æ‹·è´ï¼Œå…±äº«å†…å­˜ï¼Œæ›´å¿«,ä½†æ˜¯åªæ¥å—npæ•°ç»„è¿™ä¸€ä¸ªå‚æ•°ã€‚



### 137ã€åˆ›å»ºå­å›¾

plt.subplot()æ˜¯åˆ†åˆ«åˆ›å»ºå­å›¾ï¼Œè€Œplt.subplotsï¼ˆï¼‰æ˜¯ä¸€æ¬¡æ€§åˆ›å»ºå­å›¾ã€‚



### 138ã€lenå‡½æ•°

len(data)ï¼Œè¯¥å‡½æ•°åªä¼šè¿”å›æ•°æ®æœ€å¤–å±‚ç»´åº¦



### 139ã€v2.RandomAffine

```python
    v2.RandomAffine(degrees=15,translate=(0.1,0.1),scale=(0.9,1.1),shear=10)
```

degreeä¸ºéšæœºæ—‹è½¬çš„è§’åº¦èŒƒå›´ï¼Œtranslateè¡¨ç¤ºåœ¨æ°´å¹³æ–¹å‘å’Œå‚ç›´æ–¹å‘æœ€å¤šå¹³ç§» 10%ï¼Œscaleè¡¨ç¤ºéšæœºç¼©æ”¾åˆ°åŸå§‹å¤§å°çš„0.9~1.1ï¼Œshearè¡¨ç¤ºéšæœºé”™åˆ‡çš„èŒƒå›´æ˜¯-10 ~10.



### 140ã€åŸºçº¿æ¨¡å‹

**DummyClassifier** 

å‚æ•°strategy="most_frequent"è¡¨ç¤ºæ¨¡å‹å§‹ç»ˆé¢„æµ‹æ•°é‡æœ€å¤šçš„é‚£ä¸ªç±»ï¼Œå½“ç±»åˆ«ä¸å¹³è¡¡æ—¶ï¼Œå¯ä»¥ç”¨ã€‚strategy="stratified"ï¼Œéƒ½æ²¡ä¸ªæ ·æœ¬æŒ‰è®­ç»ƒé›†çš„ç±»è¢«åˆ†å¸ƒéšæœºæŠ½æ ·ä¸€ä¸ªæ ‡ç­¾ã€‚

**DummyRegressor**

å‚æ•°strategy=â€œmeanâ€ï¼šå§‹ç»ˆé¢„æµ‹è®­ç»ƒé›†çš„å¹³å‡å€¼



### 141ã€äº¤å‰éªŒè¯

1. KFold ï¼Œè®­ç»ƒé›†æœ€å¥½é€‰å–shuffle=Trueï¼Œå› ä¸ºè¿™æ ·å¯ä»¥é¿å…åŸå§‹æ•°æ®çš„æ’åˆ—å¯¹ç»“æœçš„å½±å“ã€‚
2. StratifiedKFoldï¼Œå¯ä»¥ä¿è¯åˆ’åˆ†åçš„æ•°æ®é›†ï¼ˆè®­ç»ƒé›†å’ŒéªŒè¯é›†ï¼‰çš„æ•°æ®ç±»è¢«åˆ†å¸ƒå’ŒåŸæ•°æ®é›†ä¸€è‡´ã€‚
3. åµŒå¥—äº¤å‰éªŒè¯çš„æ€æƒ³åœ¨äºï¼šåœ¨é€‰æ‹©æœ€ä½³å‚æ•°æ—¶ï¼Œæˆ‘ä»¬æ˜¯é€šè¿‡æµ‹è¯•é›†ä¸Šçš„æµ‹è¯•åˆ†æ•°æ¥ç¡®å®šå“ªä¸ªå‚æ•°æ˜¯æœ€ä½³å‚æ•°çš„ï¼Œä½†æ˜¯è¿™æ ·çš„è¯ï¼Œæ¨¡å‹åœ¨å½“å‰æµ‹è¯•é›†ä¸Šçš„åˆ†æ•°é«˜ï¼Œä½†å¯èƒ½ä»–å‘ç”Ÿäº†è¿‡æ‹Ÿåˆï¼Œæ¢ä¸€ä¸ªæ•°æ®é›†åˆ†æ•°å°±ä¸€èˆ¬äº†ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬æå‰åˆ’åˆ†æ•°æ®é›†ï¼Œè®©æ¨¡å‹åœ¨æœªè§è¿‡çš„æ•°æ®é›†ä¸Šè¯„ä¼°æ€§èƒ½ã€‚



### 142ã€æ ‡ç­¾

å½“æ ‡ç­¾æ˜¯å­—ç¬¦ä¸²ç±»å‹æ—¶ï¼Œæ·±åº¦å­¦ä¹ åº”è¯¥æŠŠä»–ä»¬æ˜ å°„æˆæ•°å­—ã€‚ç»å…¸æœºå™¨å­¦ä¹ ä¸­çš„å›å½’æŠ€æœ¯ä¹Ÿéœ€è¦æ˜ å°„æˆæ•°å­—ï¼Œè€Œåˆ†ç±»æŠ€æœ¯åˆ™ä¸éœ€è¦ã€‚



### 143ã€è¯„ä¼°æŒ‡æ ‡

1. accuracy_score (Y_true,Y_pred)è¯„ä¼°æ¨¡å‹å‡†ç¡®ç‡ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ç›´æ¥ç”¨model.score(data,target)è¯„ä¼°ã€‚æ•´ä½“ä¸Šé¢„æµ‹å¯¹çš„æ¯”ä¾‹ã€‚
2. precision_score(ç²¾åº¦)ï¼šè¢«æ¨¡å‹é¢„æµ‹ä¸ºæ­£ç±»çš„æ ·æœ¬ä¸­ï¼ŒçœŸæ­£æ˜¯æ­£ç±»çš„æ¯”ä¾‹ã€‚
3. balanced_accuracy_score:å„ç±»åˆ«å¬å›ç‡çš„å¹³å‡å€¼ï¼Œè¿™æ‰€ä»¥ä¸æ˜¯ç²¾åº¦çš„å¹³å‡ï¼Œè¿™æ˜¯å› ä¸ºå½“ç±»åˆ«ä¸å¹³è¡¡æ—¶ï¼Œæ¨¡å‹å€¾å‘äºé¢„æµ‹å¤šæ•°ç±»ï¼Œè¿™æ ·é¢„æµ‹æˆå°‘æ•°ç±»çš„å‰æä¸‹æœ¬æ¥å°±æ˜¯å°‘æ•°ç±»çš„å¯èƒ½æ€§éå¸¸å¤§ï¼Œå¦‚æœé€‰æ‹©ç²¾åº¦çš„è¯ï¼Œåè€Œä¼šæ˜¾å¾—æ¨¡å‹æ€§èƒ½ä¼˜ç§€ï¼Œä½†è¿™æ˜¯é”™è¯¯çš„â€™è€Œé€‰æ‹©å¬å›ç‡ä¼šæ”¹å–„è¿™ç§æƒ…å†µã€‚

| æŒ‡æ ‡         | è‹±æ–‡å                        | å…¬å¼                                                        | å«ä¹‰                                 | å…³æ³¨ç‚¹ / é€‚ç”¨åœºæ™¯                               |
| ------------ | ----------------------------- | ----------------------------------------------------------- | ------------------------------------ | ----------------------------------------------- |
| **å‡†ç¡®ç‡**   | Accuracy                      | $(TP + TN) / (TP + TN + FP + FN)$                           | æ€»ä½“é¢„æµ‹æ­£ç¡®çš„æ¯”ä¾‹                   | ç±»åˆ«å¹³è¡¡æ—¶æœ€ç›´è§‚ï¼Œæ•´ä½“æ€§èƒ½æŒ‡æ ‡                  |
| **ç²¾åº¦**     | Precision / æŸ¥å‡†ç‡            | $TP/(TP+FP)$                                                | è¢«é¢„æµ‹ä¸ºæ­£ç±»çš„æ ·æœ¬ä¸­ï¼ŒçœŸæ­£æ­£ç±»çš„æ¯”ä¾‹ | è¯¯æŠ¥æˆæœ¬é«˜çš„åœºæ™¯ï¼ˆå¦‚åƒåœ¾é‚®ä»¶ã€è‚¿ç˜¤ç­›æŸ¥ï¼‰        |
| **å¬å›ç‡**   | Recall / æŸ¥å…¨ç‡ / Sensitivity | $TP/(TP+FN)$                                                | æ‰€æœ‰çœŸæ­£æ­£ç±»ä¸­ï¼Œè¢«é¢„æµ‹ä¸ºæ­£ç±»çš„æ¯”ä¾‹   | æ¼æŠ¥ä»£ä»·é«˜æ—¶ä½¿ç”¨ï¼ˆå¦‚ç—…äººæ¼è¯Šï¼‰                  |
| **F1-score** | F1                            | $2 \cdot \frac{Precision \cdot Recall}{Precision + Recall}$ | ç²¾åº¦å’Œå¬å›ç‡çš„è°ƒå’Œå¹³å‡               | å½“ Precision å’Œ Recall éƒ½é‡è¦æ—¶ï¼ˆå¦‚ç±»åˆ«ä¸å¹³è¡¡ï¼‰ |
| **ç‰¹å¼‚æ€§**   | Specificity                   | $TN/(TN+FP)$                                                | çœŸè´Ÿæ ·æœ¬è¢«æ­£ç¡®è¯†åˆ«çš„æ¯”ä¾‹             | å¤šç”¨äºåŒ»å­¦è¯Šæ–­ï¼Œå…³æ³¨è´Ÿç±»é¢„æµ‹æ­£ç¡®æ€§              |



### 144ã€æ˜¾ç¤ºå‡½æ•°ï¼ˆsklearnï¼‰

`PrecisionRecallDisplay` ä¹‹ç±»çš„å‡½æ•°ä¼šè¿”å›ä¸€ä¸ªåŒ…å«æ‰€æœ‰ç»˜å›¾å…ƒç´ çš„æ˜¾ç¤ºï¼Œæ˜¾ç¤ºå™¨æœ‰ä¸€ä¸ªax_å±æ€§ï¼Œä½ å¯ä»¥åƒå¤„ç†axé‚£æ ·è°ƒæ•´å›¾åƒã€‚



### 145ã€make_scorerï¼ˆè®¾ç½®è¯„åˆ†ï¼‰

å½“scoringå‚æ•°æŒ‡å®šè¯„ä¼°æ ‡å‡†ï¼Œå¹¶ä¸”ä»–è¿˜éœ€è¦ä¼ å…¥é¢å¤–å‚æ•°ï¼Œæ¯”å¦‚pos_labelï¼ˆæŒ‡å®šå“ªä¸ªç±»ï¼ˆå­—ç¬¦ä¸²ç±»å‹çš„ï¼‰æ˜¯æ­£ç±»ï¼‰ã€‚

```
score = make_scorer(precision_score, pos_label="donated")

```



### 146ã€pd.factorize(ç¼–ç )

è¯¥æ–¹æ³•ç”¨äºæ ‡ç­¾ç¼–ç ï¼ŒåŒæ—¶  pd.dummiesç”¨äºç‹¬çƒ­ç¼–ç ã€‚pd.factorizeï¼ˆdataï¼‰å®ƒä¼šè¿”å›ä¸¤ä¸ªå˜é‡ï¼Œç¬¬ä¸€ä¸ªæ˜¯ç¼–ç åçš„æ•°æ®ï¼Œæ•°å€¼å½¢å¼ï¼Œç¬¬äºŒä¸ªæ˜¯ç¼–ç çš„æ ‡ç­¾ï¼ˆæ˜ å°„æ–¹å¼ï¼‰ï¼Œå­—ç¬¦ä¸²å½¢å¼ã€‚



### 147ã€èšç±»  

1.   KMeans  æ–¹æ³•ï¼Œæ— ç›‘ç£å­¦ä¹ ï¼Œæ‹Ÿåˆæ•°æ®ä¹‹åï¼Œæœ‰ä¸€ä¸ªå±æ€§labels_ ï¼Œ è¡¨ç¤ºè®­ç»ƒæ•°æ®è¢«åˆ†é…çš„æ ‡ç­¾â€˜æœ‰ä¸€ä¸ªæ–¹æ³•predictï¼Œç”¨äºé¢„æµ‹æ–°æ•°æ®çš„æ ‡ç­¾ï¼Œå¯¹äºè®­ç»ƒæ•°æ®è€Œè¨€ï¼Œç»“æœå’Œlabels_ä¸€è‡´ã€‚å‚æ•°  n_init  æ§åˆ¶æ•´ä¸ªèšç±»è¿‡ç¨‹è¿›è¡Œå¤šå°‘æ¬¡ï¼Œæœ€åä¼šå–  inertia  æœ€å°çš„é‚£ä¸ªä½œä¸ºè¾“å‡ºã€‚max_iter å‚æ•°æ§åˆ¶æ¯æ¬¡èšç±»ä¼šè¿­ä»£çš„æ¬¡æ•°ï¼Œä½†æ˜¯å½“ç»“æœä¸å†æ”¾ç”Ÿå˜åŒ–æ—¶å°±ä¼šæå‰åœæ­¢ã€‚æ–¹æ³•   fit_predictï¼ˆï¼‰å¯ä»¥æ‹Ÿåˆå¹¶é¢„æµ‹æ¯è¡Œæ•°æ®çš„èšç±»æ ‡ç­¾ï¼Œæ–¹æ³•   fit_transformï¼ˆï¼‰ å¯ä»¥æ‹Ÿåˆå¹¶è®¡ç®—æ¯ä¸ªæ•°æ®ç‚¹åˆ°å„ä¸ªèšç±»ä¸­å¿ƒçš„è·ç¦»ã€‚



### 148ã€silhouette_scoreï¼ˆè½®å»“ç³»æ•°ï¼‰

èŒƒå›´åœ¨-1å’Œ1ä¹‹é—´ï¼Œè¶Šæ¥è¿‘1è¡¨ç¤ºæ•ˆæœè¶Šå¥½ï¼Œè¶Šæ¥è¿‘0è¡¨ç¤ºæ•°æ®è¢«åˆ†åˆ°äº†ä¸¤ä¸ªç°‡çš„è¾¹ç•Œï¼Œè¶Šæ¥è¿‘-1è¡¨ç¤ºæ•°æ®æ¥è¿‘å¦ä¸€ä¸ªç°‡ï¼ˆé”™è¯¯åˆ†é…ï¼‰ã€‚



### 149ã€æ•°æ®æ ‡å‡†åŒ–

ä½ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ•°æ®æ ‡å‡†åŒ–ï¼Œåªæ˜¯è®©æ¯ä¸ªç‰¹å¾å¯¹ç»“æœçš„å½±å“å°½å¯èƒ½ä¿æŒå…¬å¹³ã€‚æœ‰æ—¶ï¼ŒæŸäº›ç‰¹å¾å¯¹ç»“æœå½±å“å¾ˆå¤§ï¼Œæ­¤æ—¶è¿›è¡Œæ ‡å‡†åŒ–ï¼Œåè€Œä¼šæ‹‰ä½åˆ†æ•°ï¼Œæ‰€ä»¥å¯¹æ ‡å‡†åŒ–è¦æ…é‡çœ‹å¾…ã€‚



### 150ã€isna(pandasæ•°æ®)

data.isna()ä¼šæŒ‰åˆ—è¿”å›ç¼ºå¤±å€¼ï¼Œä¸€èˆ¬å’Œsumï¼ˆï¼‰è¿ç”¨ä»¥æ±‚å‡ºæ¯åˆ—ç¼ºå¤±å€¼çš„æ•°é‡ã€‚isna()å’Œisnull()å‡½æ•°å®Œå…¨ç­‰ä»·ã€‚



### 151ã€æ•°æ®å¯è§†åŒ–

1. plt.hist(data,bins="auto",edgecolor="black")
2. plt.pie(data,labels,autopct="%.1f%%"),å•ä¸ª%ä¼šè¢«å½“ä½œå ä½ç¬¦æ¥ä½¿ç”¨ã€‚%%æ‰ä¼šæ˜¾ç¤ºæˆ%



### 152ã€kaggleæäº¤

kaggleé»˜è®¤å°±å·¥ä½œåœ¨\kaggle\workingç›®å½•ä¸‹



### 153ã€whereå’Œapply

np.where(a,x,y) ï¼Œå¦‚æœæ¡ä»¶æ»¡è¶³è¿”å›xï¼Œå¦åˆ™è¿”å›yï¼Œè¿™æ˜¯çŸ¢é‡åŒ–è¿ç®—ï¼Œåº•å±‚ç”¨cå®ç°ï¼Œé€Ÿåº¦éå¸¸å¿«,è¿”å›çš„æ˜¯ndarrayçš„æ ¼å¼ï¼Œå¦‚æœç¥ç»ç½‘ç»œå¤„ç†ï¼Œæœ€å¥½å…ˆå–æ•°å€¼ï¼Œé¿å…åµŒå¥—ã€‚

data.apply(),é™äºpdæ•°æ®ï¼Œæœ¬è´¨æ˜¯ä¸€ä¸ªforå¾ªç¯ï¼Œå¯¹äºå¤§å‹æ•°æ®éå¸¸æ…¢ã€‚



### 154ã€cbrt

np.cbrt()ç«‹æ–¹æ ¹å‡½æ•°



### 155ã€pd.qcut()

```
pd.qcut(df['balance'], q=20, labels=False, duplicates='drop')
```

æŒ‰ç…§æ•°æ®çš„åˆ†ä½æ•°è¿›è¡Œåˆ‡åˆ†ã€‚duplicates='drop'è¡¨ç¤ºè‡ªåŠ¨ä¸¢æ‰é‡å¤çš„ç®±å­ã€‚



### 156ã€plt.legend()

è®¾ç½®å›¾ä¾‹ï¼Œ    plt.legend(bbox_to_anchor=(1.05,1),loc="upper left")



### 157ã€roc_auc_score

è¯¥åˆ†æ•°éœ€è¦ä½ ä½“å“¦é‚£ä¸ªè¿ç»­çš„æ¦‚ç‡å€¼ï¼Œä»¥ä¾¿æ¨¡å‹é€‰æ‹©é˜ˆå€¼ï¼Œå› æ­¤ä½ ä¸èƒ½ç›´æ¥ç¡¬é¢„æµ‹ï¼Œè€Œåº”è¯¥

predict_probaï¼ˆdataï¼‰[:,1],ä¹‹æ‰€ä»¥é€‰æ‹©ç¬¬äºŒåˆ—ï¼Œæ˜¯å› ä¸ºæˆ‘ä»¬å¸Œæœ›åˆ†æ•°è¶Šå¤§è¡¨ç¤ºæ¨¡å‹è¶Šèƒ½ç›¸ä¿¡æ˜¯æ­£ç±»ã€‚



### 158ã€transformå˜æ¢

æ–¹æ³•fit_transformå®é™…ä¸Šæ˜¯å­¦ä¹ ä¼ å…¥æ•°æ®çš„ç‰¹å¾ï¼Œå¦‚å‡å€¼ã€æ–¹å·®ç­‰ï¼Œä¹‹åå†å¯¹å…¶è¿›è¡Œå˜æ¢ï¼Œä¸€èˆ¬ç”¨äºè®­ç»ƒé›†ã€‚è€Œtransformæ–¹æ³•æ ¹æ®ä¹‹å‰å­¦åˆ°çš„ç‰¹å¾è¿›è¡Œå˜æ¢ï¼Œä¸€èˆ¬ç”¨äºéªŒè¯é›†å’Œæµ‹è¯•é›†ã€‚



### 159ã€combinations

itertoolsæ˜¯pythonå†…ç½®çš„è¿­ä»£å™¨æ¨¡å—ï¼Œcombiantionsä¼šç”Ÿæˆæ— é‡å¤çš„å…ƒç´ ç»„åˆ

```python
combinations([A, B, C], 2)
(A, B), (A, C), (B, C)
```



### 160ã€dataloader å’Œdataset

datasetåªéœ€è¦å®ç°ä¸€ä¸ªæ•°æ®çš„å–å€¼å³å¯ï¼Œå› ä¸ºdataloaderä¸€æ¬¡åªæä¾›ç»™å®ƒä¸€ä¸ªç´¢å¼•ï¼Œç„¶åé€æ­¥æŠŠä»–ä»¬åŒ…è£…æˆbatchã€‚



### 162ã€requires_grad

å½“ä½ åˆ›å»ºä¸€ä¸ªæ–°çš„moduleå¯¹è±¡æ—¶ï¼Œå…¶é»˜è®¤å‚æ•°çš„æƒé‡å’Œåç½®éƒ½æ˜¯å¯è®­ç»ƒçš„ã€‚



### 163ã€åˆ†ç±»ä»»åŠ¡

ä¿æŒæ ‡ç­¾ä¸ºä¸€ç»´å³å¯ã€‚



### 164ã€dropnaæ–¹æ³•

```python
data.dropna(axis=0,subset=["A"],inplace=True)
```

è¡¨ç¤ºæ£€æŸ¥æ•°æ®Aåˆ—ï¼Œå¦‚æœæœ‰ç¼ºå¤±å€¼å°±åˆ é™¤é‚£ä¸€è¡Œæ•°æ®ï¼Œå°±åœ°åˆ é™¤ã€‚å‚æ•°subsetè¡¨ç¤ºå¤„ç†å“ªäº›ç‰¹å¾æ•°æ®ã€‚



### 165ã€Imputer

ç”¨äºå¡«å……æ•°æ®ä¸­çš„ç¼ºå¤±å€¼ï¼Œé»˜è®¤æ˜¯å¹³å‡å€¼å¡«å……



### 166ã€XGB

**n_estimators** è¡¨ç¤ºå»ºæ¨¡çš„æ¬¡æ•°ï¼Œå€¼å¤ªå°ä¼šå¯¼è‡´æ‹Ÿåˆä¸è¶³ï¼Œå€¼å¤ªå¤§åˆä¼šå¯¼è‡´è¿‡æ‹Ÿåˆã€‚

**early_stopping_rounds**  ä¼šåœ¨éªŒè¯åˆ†æ•°åœæ­¢æé«˜æ—¶åœæ­¢è¿­ä»£ï¼Œä¸€èˆ¬è®¾ç½®ä¸º5å³å¯ï¼Œæ¨¡å‹åœ¨æ‹Ÿåˆè¿‡ç¨‹ä¸­ï¼Œå¯ä»¥è®¾ç½® eval_set=[(x_val,y_val)] è¡¨ç¤ºç”¨å“ªäº›æ•°æ®æ¥è®¡ç®—æŒ‡æ ‡ã€‚

**learning_rate** è¡¨ç¤ºå­¦ä¹ ç‡

**gamma** è¡¨ç¤ºåˆ†è£‚ç»“ç‚¹æ‰€éœ€çš„æœ€å°ä¸‹é™å€¼ï¼Œå½“gammaå¤§äºå¢ç›Šæ—¶ï¼Œä¼šå¯¹æ ‘è¿›è¡Œè£å‰ªã€‚

**min_child_weight** ä¸€ä¸ªå¶èŠ‚ç‚¹ä¸Šçš„æœ€å°å‚æ•°æƒé‡

**eval_metric** è¡¨ç¤ºè¯„ä¼°æ ‡å‡†ï¼Œåº”è¯¥åœ¨åˆå§‹åŒ–çš„æ—¶å€™å°±ä¼ å…¥

**early_stopping_rounds** è¡¨ç¤ºè®­ç»ƒç»“æœä¸å†æå‡å°±åœæ­¢çš„è½®æ•°

ç›¸ä¼¼åº¦åˆ†æ•° ä¼šè¡¡é‡ç»“ç‚¹çš„çº¯å‡€ç¨‹åº¦ï¼›å¢ç›Šæ˜¯åˆ†è£‚å‰åç›¸ä¼¼åº¦åˆ†æ•°çš„å·®å€¼ï¼Œå†³å®šæ˜¯å¦åˆ†è£‚ï¼›å¶å­è¾“å‡ºå€¼ç”¨ç»“ç‚¹æ¢¯åº¦å’Œè®¡ç®—å‡ºæ¥ï¼Œä»¥å†³å®šåˆ†è£‚å®Œæˆåé¢„æµ‹æ›´æ–°å¤šå°‘ã€‚





### 167ã€Hyperopt 

#### 1ã€åŸºæœ¬æ–¹æ³•

| æ–¹æ³•                               | æ„æ€                                                         |
| ---------------------------------- | ------------------------------------------------------------ |
| `hp.quniform(label, low, high, q)` | ç¦»æ•£å‡åŒ€åˆ†å¸ƒï¼Œå–å€¼åœ¨ `[low, high]`ï¼Œæ­¥é•¿ qï¼Œæ¯”å¦‚ max_depth=3~18ï¼Œæ¯æ¬¡å–æ•´æ•°ï¼Œç”Ÿæˆçš„æ˜¯æµ®ç‚¹æ•° |
| `hp.uniform(label, low, high)`     | è¿ç»­å‡åŒ€åˆ†å¸ƒï¼Œå–å€¼åœ¨ `[low, high]`ï¼Œå¯ä»¥æ˜¯æµ®ç‚¹æ•°             |

è¿™äº›æ–¹æ³•è¿”å›çš„ä¸æ˜¯ä¸€ä¸ªæ•°ï¼Œè€Œæ˜¯ä¸€ä¸ªâ€œæœç´¢ç©ºé—´è¡¨è¾¾å¼â€ï¼Œç±»å‹æ˜¯  Apply(Hyperoptçš„å†…éƒ¨å¯¹è±¡)



#### 2ã€è¿”å›å€¼

Hyperopt è§„å®šï¼šç›®æ ‡å‡½æ•°å¿…é¡»è¿”å›ä¸€ä¸ªå­—å…¸ï¼Œå‘Šè¯‰å®ƒï¼š

1. å½“å‰è¶…å‚æ•°ç»„åˆçš„ **æŸå¤±å€¼** (`loss`)ï¼ˆä¼˜åŒ–çš„ç›®æ ‡å¿…é¡»æ˜¯è¶Šå°è¶Šå¥½ï¼Œå› æ­¤ä½¿ç”¨ fminä¼˜åŒ–ï¼Œå¯¹äºå‡†ç¡®ç‡ï¼Œé€šå¸¸åŠ ä¸€ä¸ªè´Ÿå·ã€‚ï¼‰
2. å½“å‰å°è¯•æ˜¯å¦æˆåŠŸ (`status`)

```
return {
    'loss': <float>,      # è¦æœ€å°åŒ–çš„ç›®æ ‡å€¼
    'status': STATUS_OK   # çŠ¶æ€æ ‡è¯†
}
```



#### 3ã€è§£å†³é—®é¢˜çš„ä¸€èˆ¬æ­¥éª¤

1. é¦–å…ˆæ˜¯æ‰¾åˆ°è¦è°ƒèŠ‚çš„å‚æ•°å’Œè°ƒå‚èŒƒå›´
2. è®¾ç½®æ±‚è¯„ä¼°åˆ†æ•°çš„å‡½æ•°ï¼Œæœ€åè¿”å›ä¸€ä¸ªå­—å…¸
3. å¯»æ±‚æœ€ä½³è¶…å‚æ•°

```python
trials = Trials()

best_hyperparams = fmin(fn = objective, # ç›®æ ‡å‡½æ•°
                        space = space, # å‚æ•°ç©ºé—´
                        algo = tpe.suggest,  # æœç´¢ç®—æ³•
                        max_evals = 100,   # ç›®æ ‡å‡½æ•°è¢«è°ƒç”¨çš„æ¬¡æ•°
                        trials = trials)   # è®°å½•å°è¯•ç»“æœ
```

`tpe.suggest` â†’ Tree-structured Parzen Estimatorï¼Œè´å¶æ–¯ä¼˜åŒ–ï¼Œæ¨èä½¿ç”¨

`rand.suggest` â†’ éšæœºæœç´¢

`anneal.suggest` â†’ æ¨¡æ‹Ÿé€€ç«



### 168ã€ç‰¹å¾å·¥ç¨‹

#### 1ã€MIï¼ˆäº’ä¿¡æ¯ï¼‰

è¡¡é‡ä¸€ä¸ªé‡çš„è‡³ä¸‰åå†å¤šå¤§ç¨‹åº¦ä¸Šå‡å°‘å¯¹å¦ä¸€ä¸ªé‡çš„ä¸ç¡®å®šæ€§çš„åº¦é‡ï¼ŒæŒ‡è¶Šå¤§è¶Šå¥½ï¼Œ0.5 ~ 1è¡¨ç¤ºä¸­ç­‰å…³ç³»ï¼Œ1 ~ 2è¡¨ç¤ºå¼ºå…³ç³»ï¼Œå¤§äº2è¡¨ç¤ºå®Œç¾é¢„æµ‹ã€‚ä½†æ˜¯MIå¢é•¿ç¼“æ…¢ï¼Œå°±åƒå¯¹æ•°ä¸€æ ·ã€‚ä½†æ˜¯å‘¢MIåªçœ‹çœ‹ä¸ªç‰¹å¾ï¼Œå¿½ç•¥å…¶ä»–ç‰¹å¾çš„å…³ç³»ã€‚å¹¶ä¸”å‘¢ï¼ŒMIçŸ¥è¯†å¸®ä½ æ‰¾åˆ°æœ‰ä»·å€¼ç‰¹å¾ï¼Œå¹¶ä¸ä¼šç›´æ¥å¸®åŠ©ä½ è®­ç»ƒï¼Œéœ€è¦åšç‰¹å¾å¤„ç†æ‰èƒ½ä½¿æ¨¡å‹å¥å£®ã€‚

åœ¨ sklearn ä¸­ï¼Œ

```
from sklearn.feature_selection import mutual_info_regression

# å‚æ•° discrete_features ä¼šæ ‡è®°ç¦»æ•£ç‰¹å¾ä»¥ä¾¿æ¨¡å‹åšå•ç‹¬å¤„ç†
```

ä¸€æ–¹é¢ï¼Œé€šè¿‡äº’ä¿¡æ¯ï¼Œä½ å¯ä»¥çœ‹åˆ°ä¸€äº›ç‰¹å¾æ˜¯ç¨€æœ‰ç‰¹å¾ï¼Œå¯¹å¤§å¤šæ•°æ•°æ®æ²¡æœ‰ä»€ä¹ˆç”¨ï¼Œåè€Œä¼šæ‰°ä¹±æ•´ä¸ªæ•°æ®é›†çš„è®­ç»ƒï¼Œæ‰€ä»¥æˆ‘ä»¬é€šå¸¸è¦**é¿å…å°‘é‡æ•°æ®ç‰¹æœ‰ç‰¹å¾**å¯¹æ•´ä¸ªæ•°æ®çš„å½±å“ã€‚å¦ä¸€æ–¹é¢ï¼ŒMIå¯¹äºäº¤äº’ç‰¹å¾å¹¶ä¸æ•æ„Ÿï¼Œå› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦è§‚å¯Ÿæ•°æ®ç‰¹å¾ï¼Œå¯»æ‰¾å¯èƒ½æœ‰å…³è”çš„ä¿¡æ¯ï¼Œå¯èƒ½å®ƒçš„MIè¾ƒä½ï¼Œä½†å¹¶ä¸æ„å‘³ç€ä¸é‡è¦ã€‚

#### 2ã€å¤„ç†ç‰¹å¾

ä½ å¯ä»¥ä¸ºæ–°å»ºæ•°æ®ç‰¹å¾ï¼Œå¸¸è§çš„æœ‰æ±‚å’Œã€æ˜¯å¦å¤§äºæŸä¸ªå€¼ã€å°†ç‹¬ç‰¹çš„å­—ç¬¦ä¸²åˆ†å‰²æˆå¤šä¸ªç‰¹å¾ã€åˆ†ç»„å˜æ¢ï¼ˆæ±‚å‡ºä¸åŒç±»åˆ«å…·æœ‰çš„ç‰¹ç‚¹ï¼Œå¯ä»¥æ˜¯å¹³å‡å€¼ã€æ¯”ä¾‹æˆ–è€…æ•°ç›®ç­‰ï¼‰

å¯¹äºä¸å¯æ¯”çš„æ•°æ®ï¼Œé€šå¸¸ä¼šè¿›è¡Œç¼©æ”¾ã€‚å¯¹äºå¯æ¯”çš„æ•°æ®ï¼Œéœ€è¦è§†æƒ…å†µé€‰æ‹©ï¼Œå› ä¸ºè¯¥æ•°æ®è•´å«äº†ç›´æ¥çš„å¤§å°å…³ç³»ï¼Œå¦‚æœç¼©æ”¾çš„è¯åªèƒ½å¾—åˆ°ç›¸å¯¹å…³ç³»ï¼Œä¸¢å¤±ç»å¯¹å…³ç³»ã€‚

#### 3ã€PCAï¼ˆä¸»æˆåˆ†åˆ†æï¼‰

æŠŠæ•°æ®æ ‡å‡†åŒ–ä¹‹åï¼ŒPCAå®é™…ä¸Šå®åœ¨åˆ†æå˜é‡ä¹‹é—´çš„ç›¸å…³æ€§ç»“æ„ã€‚å¦‚æœä¸æ ‡å‡†åŒ–ï¼ŒPCAåˆ™æ˜¯åœ¨åˆ†æåé˜²æ“¦æ±—ç»“æ„ã€‚PCAä¼šæ‰¾å‡ºæ•°æ®å˜åŒ–æœ€å¤§çš„æ–¹å‘ï¼Œä¹Ÿå°±æ˜¯èƒ½å¤Ÿå¾ˆå¥½åŒºåˆ†è¿™äº›æ•°æ®ç‚¹çš„â€œä¸»æ–¹å‘â€ï¼ˆPC1ï¼‰ï¼Œæ­¤æ—¶ç¬¬ä¸€ä¸»æˆåˆ†ä¸å†æ˜¯å•ä¸ªç‰¹å¾ï¼Œè€Œæ˜¯å¤šä¸ªç‰¹å¾çš„æŸç§çº¿æ€§ç»„åˆã€‚ç´§æ¥ç€ï¼ŒPCAä¼šæ‰¾ä¸€ä¸ªå’Œä¸»æˆåˆ†æ–¹å‘å‚ç›´çš„æ–¹å‘ï¼Œè§£é‡Šå‰©ä½™çš„å˜åŒ–ã€‚æ–°ç‰¹å¾æ˜¯åŸå§‹ç‰¹å¾çš„çº¿æ€§ç»„åˆï¼Œæ–°ç‰¹å¾ç§°ä¸ºæ•°æ®çš„ä¸»æˆåˆ†ï¼Œæƒé‡ç§°ä¸ºè½½è·ã€‚

PC1æ‰¾åˆ°çš„æ˜¯å˜åŒ–æœ€å¤§çš„æ–¹å‘ï¼Œä½†æ˜¯æ•°æ®ä¸æ­¢æ²¿ç€è¯¥æ–¹å‘å˜åŒ–ï¼Œæ‰€ä»¥å°±æœ‰äº†PC2ã€PC3ç­‰ã€‚PC2ä¸PC1å‚ç›´ï¼Œå› ä¸ºå¦‚æœä¸å‚ç›´ï¼ŒäºŒè€…å°±ä¼šæ•æ‰ä¸€äº›ç›¸åŒçš„ä¿¡æ¯ï¼Œé€ æˆèµ„æºæµªè´¹ã€‚å˜åŒ–æœ€å¤§çš„æ–¹å‘ä¹Ÿå°±æ˜¯æ–¹å·®æœ€å¤§çš„æ–¹å‘ï¼Œé«˜æ–¹å·®è¡¨ç¤ºæ•°æ®å˜åŒ–å¤§ï¼Œè•´å«çš„ä¿¡æ¯å¤šï¼Œé‡è¦ï¼›ä½æ–¹å·®è¡¨ç¤ºæ•°æ®ä¸æ€ä¹ˆå˜åŒ–ï¼Œå› æ­¤è•´å«çš„ä¿¡æ¯ä¹Ÿæ¯”è¾ƒå°‘ï¼Œå¯ä»¥è€ƒè™‘èˆå¼ƒã€‚

PCAæœ‰ä¸¤ç§ä¸»è¦çš„åº”ç”¨æ–¹æ³•ã€‚ç¬¬ä¸€ç§æ˜¯ç”¨ä½œæè¿°æ€§æŠ€æœ¯ï¼Œå› ä¸ºPCAæ­ç¤ºäº†åŸå§‹æ•°æ®çš„å˜åŒ–æ–¹å‘ï¼Œå¯ä»¥æ®æ­¤æ¥è®¾è®¡ä¼˜ç§€ç‰¹å¾ã€‚ç¬¬äºŒç§æ˜¯ç›´æ¥å°†ä¸»æˆåˆ†ä½œä¸ºç‰¹å¾ä½¿ç”¨ï¼Œæœ‰é™ç»´ã€å¼‚å¸¸æ£€æµ‹ã€å»å™ªå’Œå»ç›¸å…³æ€§ï¼Œä¸‹é¢ä¸€ä¸€å±•å¼€ã€‚é¦–å…ˆæ˜¯é™ç»´ï¼ŒPCAä¼šæ‰¾åˆ°é«˜æ–¹å·®ä¸»æˆåˆ†ï¼ŒæŠŠå†—ä½™ä¿¡æ¯é›†ä¸­åˆ°å°‘æ•°æˆåˆ†ä¸­å¹¶ä¸¢å¼ƒã€‚ç¬¬äºŒæ˜¯å¼‚å¸¸æ£€æµ‹ï¼Œå¼‚å¸¸ç‚¹åœ¨åŸå§‹é«˜ç»´ç©ºé—´ä¸­å¯èƒ½ä¸æ˜æ˜¾ï¼Œåœ¨ä½æ–¹å·®ä¸»æˆåˆ†å¯¹åº”å¾—æ–¹å‘ä¸Šä¼šåç¦»ç¾¤ä½“ï¼Œåœ¨è¯¥æ–¹å‘ä¸Šæ›´å®¹æ˜“è¢«å‘ç°ã€‚ç¬¬ä¸‰æ˜¯é™å™ªï¼Œé«˜æ–¹å·®ä¸»æˆåˆ†æ˜¯ä¸»è¦ä¿¡å·ï¼Œä½æ–¹å·®ä¸»æˆåˆ†æ˜¯èƒŒæ™¯å™ªå£°ï¼Œé€šå¸¸æˆ‘ä»¬ä¼šä¿ç•™é«˜æ–¹å·®åˆ†é‡ï¼Œä¸¢å¼ƒå™ªå£°ã€‚ç¬¬å››æ˜¯å»ç›¸å…³æ€§ï¼Œå› ä¸ºä¸€äº›ç®—æ³•ï¼ˆå¦‚çº¿æ€§å›å½’ã€KNNç­‰ï¼‰å¯¹é«˜åº¦ç›¸å…³ç‰¹å¾æ•æ„Ÿï¼Œè€ŒPCAè¾“å‡ºå¾—ä¸»æˆåˆ†å½¼æ­¤æ­£äº¤ï¼Œæ— ç›¸å…³æ€§ï¼Œå¯ä»¥åŠ é€Ÿæ”¶æ•›ã€‚

#### 4ã€æ— ç›‘ç£å­¦ä¹ 

æ— ç›‘ç£å­¦ä¹ å¯ä»¥ä½œä¸ºç‰¹å¾å‘ç°æŠ€æœ¯ã€‚





### 169ã€å¸ƒå°”å€¼

åŸæ¥å¸ƒå°”å€¼æ˜¯å¯ä»¥ç›¸åŠ çš„ï¼Œå› ä¸ºå¸ƒå°”é€»è¾‘æœ¬è´¨ä¸Šæ˜¯ 0/1 è¿ç®—ï¼Œhhã€‚



### 170ã€gt

pandasæ•°æ®åˆgtæ–¹æ³•ç”¨äºæ¯”è¾ƒå€¼

```python
data.gt(x) #  è¿”å›å¤§äºxçš„å¸ƒå°”çŸ©é˜µ
```



### 171ã€è·¨è¡Œè¡¨è¾¾å¼

ï¼ˆï¼‰ã€[]ã€{ } å¯ä»¥è®©ä¸€è¡Œæ•°æ®è·¨è¡Œä¹¦å†™ï¼Œä¿è¯ä»£ç æ¸…æ™°æ˜äº†



### 172ã€str  è®¿é—®å™¨

```python
data.str.lower()
data.str.split(".",n=1expand=True)
```

strè®¿é—®å™¨å¯ä»¥å¯¹pandasæ•°æ®è¿›è¡Œå­—ç¬¦ä¸²æ“ä½œï¼Œå…¶ä¸­expandå‚æ•°å¯ä»¥è®©æ•°æ®åˆ†å‰²æˆä¸¤åˆ—æ•°æ®ï¼Œè€Œä¸å†æ˜¯åˆ—è¡¨ï¼Œå‚æ•°nè¡¨ç¤ºåªå†ç¬¬ä¸€å¤„è¿›è¡Œæ‹†åˆ†ã€‚



### 172ã€mapå’Œapply

mapé’ˆå¯¹seriesæ•°æ®ï¼Œå³å•åˆ—æ•°æ®å¤„ç†ï¼Œè€Œapplyæ—¢å¯ä»¥å¤„ç†å•åˆ—æ•°æ®åˆå¯ä»¥å¤„ç†è¡¨æ ¼æ•°æ®ã€‚



### 173ã€transform

å¯¹äºpandasæ•°æ®ï¼Œæœ‰transformæ–¹æ³•ï¼Œå¯ä»¥å¯¹æ¯ä¸ªåˆ†ç»„æ¹–æ³Šè¿™æ¯åˆ—åº”ç”¨å‡½æ•°ï¼Œç„¶åè¿”å›ä¸€ä¸ªå’ŒåŸå¯¹è±¡ç›¸åŒçš„ç»“æœã€‚æœ‰max`ã€`min`ã€`median`ã€`var`ã€`std` å’Œ `countå¯ä»¥é€‰æ‹©



### 174ã€mul

data.mul(data2 ,axis=0)è¡¨ç¤ºæŒ‰è¡Œé€å…ƒç´ ç›¸ä¹˜ï¼Œè™½ç„¶axisè¿èƒŒäº†ç›´è§‰ã€‚



### 175ã€pd.get_dummies

è¯¥å‡½æ•°ç”¨äºç‹¬çƒ­ç¼–ç ï¼Œå‚æ•°prefix=" "æŒ‡å®šå­—ç¬¦ä¸²ï¼Œå¯ä»¥åœ¨ç”Ÿæˆçš„åˆ—åå‰é¢åŠ ä¸Šä»–ã€‚



### 176ã€hueå‚æ•°

åœ¨snsç»˜å›¾é‡Œé¢ï¼Œè¯¥å‚æ•°å¯ä»¥è®¾ç½®ç‚¹çš„é¢œè‰²

| åœºæ™¯             | ç¤ºä¾‹                                | è¯´æ˜                                                       |
| ---------------- | ----------------------------------- | ---------------------------------------------------------- |
| **åˆ†ç±»å˜é‡åˆ†ç»„** | `hue="species"`                     | æœ€å¸¸è§çš„ç”¨æ³•ï¼Œä¸åŒç±»åˆ«ä¸åŒé¢œè‰²                             |
| **äºŒåˆ†ç±»ç›®æ ‡**   | `hue="target"`                      | æ­£è´Ÿæ ·æœ¬ç”¨ä¸åŒé¢œè‰²ï¼Œçœ‹åˆ†å¸ƒå·®å¼‚                             |
| **èšç±»ç»“æœ**     | `hue="Cluster"`                     | ä¸åŒèšç±»ç»“æœä¸åŒé¢œè‰²ï¼ˆæ­é… `astype("category")` æ•ˆæœæ›´å¥½ï¼‰ |
| **åˆ†ç»„å¯¹æ¯”**     | `hue="gender"`                      | ç”·/å¥³ç”¨ä¸åŒé¢œè‰²çœ‹è¶‹åŠ¿                                      |
| **æ•°å€¼æ˜ å°„é¢œè‰²** | `hue="value"` + `palette="viridis"` | ç”¨æ¸å˜è‰²è¡¨ç¤ºå¤§å°ï¼Œå¸¸è§äºæ•£ç‚¹å›¾æˆ–çƒ­åŠ›å›¾                     |



### 177ã€popæ–¹æ³•

pandsæ•°æ®å¯ä»¥ä½¿ç”¨popæ–¹æ³•åˆ é™¤æŸä¸€åˆ—æ•°æ®ï¼ŒåŒæ—¶èµ‹å€¼ç»™å¦ä¸€ä¸ªæ•°æ®

```
y=x.pop("salesprice")
```



### 178ã€cpoyæ–¹æ³•

```python
data.copy(deep=True)
```

é»˜è®¤æ˜¯æ·±æ‹·è´ï¼Œä¹Ÿå°±æ˜¯è¯´æ‹·è´å‡ºçš„æ•°æ®ä¸åŸæ•°æ®ä¸å…±äº«åº•å±‚ã€‚



### 179ã€join ï¼ˆè¡Œç´¢å¼•å¯¹é½ï¼‰

```python
data.join(x)
```

æŒ‰è¡Œç´¢å¼•å¯¹é½ï¼ŒæŠŠxç›´æ¥æ·»åŠ åˆ°dataå³ä¾§



### 180ã€nunique  å’Œ  unique

pd  æ•°æ®æœ‰è¿™ä¸¤ç§æ–¹æ³•ã€‚nuniqueå¯ä»¥è¿”å›å„ä¸ªç‰¹å¾å¾—ç±»åˆ«æ•°ï¼Œuniqueåˆ™ä¼šè¿”å›å„ä¸ªç‰¹å¾å¾—ç‹¬ç‰¹æ ‡ç­¾æ•°å€¼æˆ–è€…è¯´åå­—ã€‚value_countsåˆ™æ˜¯æŸ¥çœ‹ä¸€åˆ—æ•°æ®ä¸­çš„ç±»åˆ«å’Œç›¸åº”çš„æ ·æœ¬æ•°é‡ï¼Œè¦æ³¨æ„åŒºåˆ†ã€‚



### 181ã€smapleæ–¹æ³•

pdæ•°æ®æœ‰sampleæ–¹æ³•ï¼Œå¯ä»¥éšæœºæŠ½å–è¡Œï¼Œå‚æ•°fracè¡¨ç¤ºæŠ½å–æ•°æ®å¾—æ¯”ä¾‹ã€‚

```python
X_encode = X.sample(frac=0.25)
```



### 182ã€ M-Estimate ç¼–ç 

```python
encoder = MEstimateEncoder(cols=["Zipcode", "Neighborhood"], m=5.0)

```

$$
\text{EncodedValue}_c = \frac{n_c \cdot \text{mean}_c + m \cdot \text{global mean}}{n_c + m}
$$

è¯¥ç¼–ç æ–¹å¼ä¼šå¯¹ç±»åˆ«åˆ—ä¸­çš„æ¯ä¸ªç±»è¢«ï¼Œè®¡ç®—ç±»åˆ«åœ¨ç›®æ ‡å˜é‡ä¸Šçš„å¹³å‡å€¼ï¼Œæœ‰å‚æ•°mï¼Œæ§åˆ¶å°ç±»åˆ«çš„å½±å“ã€‚mè¶Šå¤§ï¼Œå€¼è¶Šæ¥è¿‘å…¨å±€å¹³å‡ï¼Œç”¨äºå‡å°å°ç±»åˆ«çš„å½±å“ï¼Œmè¶Šå°ï¼Œå€¼è¶Šæ¥è¿‘ç±»åˆ«å‡å€¼ï¼Œå…¶ç¼–ç å€¼æ˜¯è¿ç»­å€¼ï¼Œè¿™æ˜¯éœ€è¦è®°ä½çš„ã€‚å¯ä»¥èµ·åˆ°  â€œé™ç»´â€ çš„æ•ˆæœã€‚

è¯¥ç¼–ç æ–¹å¼åœ¨ç‰¹å¾ç±»åˆ«æ•°å¤§ï¼Œä¸å¥½ç›´æ¥ç‹¬çƒ­ç¼–ç ï¼ŒåŒæ—¶ä¹Ÿä¸æƒ³å¼•å…¥é¡ºåºå…³ç³»ï¼ˆä½†æ˜¯ï¼Œå¯¹æ ‘æ¨¡å‹è€Œè¨€æ˜¯æ²¡æœ‰é¡ºåºè¿™ä¸ªæ¦‚å¿µçš„ï¼‰ã€‚

éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç¼–ç æ—¶ï¼Œä½ éœ€è¦å•ç‹¬åˆ’åˆ†å‡ºä¸€éƒ¨åˆ†æ•°æ®ä¸“é—¨ç”¨äºç¼–ç ï¼Œé˜²æ­¢äº§ç”Ÿæ•°æ®æ³„éœ²ã€‚

















## 2.é¡¹ç›®å¿ƒå¾—

### 1. `titanic` ç«èµ›

1. éšæœºæ£®æ—åœ¨åˆ†ç±»ç«èµ›ä¸­å¯ä»¥ä¼˜å…ˆè€ƒè™‘ã€‚

2. å¤„ç†æ•°æ®æ—¶ï¼Œå¯ä»¥å…ˆé€šè¿‡è¿™äº›æ‰‹æ®µæ¥è¯„ä¼°æ•°æ®ï¼Œå¹¶è¿›è¡Œç¼ºå¤±å€¼æ˜¾ç¤ºã€å¤„ç†ï¼Œå­—ç¬¦ä¸²æ•°æ®è½¬æ¢ï¼ˆåˆ†æœ‰åºå’Œæ— åºï¼‰

   ```
   data.info()
   data.describe()
   data[target].value_counts()
   
   ```

3. å¯ä»¥é€šè¿‡äº¤å‰éªŒè¯æŸå¤±ï¼Œå¹¶å¾—åˆ°æ¨¡å‹

4. å¯¹äºè®­ç»ƒé›†ï¼Œå…ˆè¿›è¡Œæ•°æ®åˆ’åˆ†ï¼Œä»¥ä¾¿ä¹‹åè¿›è¡Œæ¨¡å‹è¯„ä¼°

5. æ·±åº¦å­¦ä¹ ä¸æ˜¯å”¯ä¸€æ‰‹æ®µï¼Œä¹Ÿå¯ä»¥ç»“åˆsklearnå¤„ç†ã€‚

6. æœ¬æ¬¡ç«èµ›ä¸­ï¼Œå­¦ä¼šäº†åˆ©ç”¨sklearnå¤„ç†æ•°æ®çš„æ‰‹æ®µï¼Œæ¯”å¦‚kæŠ˜äº¤å‰éªŒè¯ï¼Œæ•°æ®åˆ’åˆ†ï¼Œæ•°æ®æŒ‰åˆ—åˆ†åˆ«å¤„ç†ï¼ŒåŸºçº¿æ¨¡å‹ã€‚



### 2.`house-price`ç«èµ›

1. å¦‚æœç›®æ ‡æ•°å€¼å¤§ï¼Œä¸”è·¨åº¦å¤§ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨å¯¹æ•°æŸå¤±ã€‚åŒæ—¶ä½ éœ€è¦å¯¹`target` å…ˆè¿›è¡Œå¯¹æ•°å˜åŒ–ï¼Œåè¿›è¡Œæ ‡å‡†åŒ–ï¼Œä»¥ç¼©å°èŒƒå›´ï¼Œä¾¿äºæ¨¡å‹æ‹Ÿåˆã€‚ä¹‹åå†åæ ‡å‡†åŒ–å’Œå¯¹æ•°åŒ–ã€‚

   ```python
   def log_rmse(net, features, labels):
       """
       è®¡ç®—å¯¹æ•°å‡æ–¹æ ¹è¯¯å·®ï¼ˆlog RMSEï¼‰ï¼Œè¿”å› PyTorch å¼ é‡ã€‚
       
       å‚æ•°ï¼š
           net: ç¥ç»ç½‘ç»œæ¨¡å‹
           features: è¾“å…¥ç‰¹å¾å¼ é‡ï¼Œå½¢çŠ¶ [batch_size, n_features]
           labels: æ ‡å‡†åŒ–çš„ç›®æ ‡å¼ é‡ï¼Œå½¢çŠ¶ [batch_size, 1]
       
       è¿”å›ï¼š
           torch.Tensor: log RMSE æŸå¤±
       """
       pred = net(features)
       mse = ((pred - labels) ** 2).mean()  # æ ‡å‡†åŒ–çš„ MSE
       return torch.sqrt(mse)  # è¿”å›å¼ é‡ï¼Œä¿ç•™è®¡ç®—å›¾
   ```

2. å¯ä»¥æŠŠè®­ç»ƒé›†å’Œæµ‹è¯•é›†å…ˆåˆå¹¶èµ·æ¥ï¼Œä¸€å¹¶å¤„ç†ï¼Œä¹‹åå†åˆ†å¼€ã€‚

3. `numeric_data = data.dtypes[data.dtypes != "object"].index`å¯ä»¥å¿«é€Ÿæå–æ•°å€¼ç‰¹å¾ã€‚

4. pandasæ•°æ®è½¬æ¢ä¸ºå¼ é‡æ—¶ï¼Œå…ˆdata.valuesï¼ŒæŠŠæ•°æ®è½¬æ¢æˆnpæ•°ç»„ï¼Œä¹‹åå†è½¬æ¢æˆå¼ é‡ã€‚

5. åŠ è½½æ•°æ®æ–¹æ³•ï¼Œå…ˆDatasetï¼Œåè¿›è¡ŒDataloader

   ```python
   def dataloader(data, batch_size, is_train):
       dataset = TensorDataset(*data)
       return DataLoader(dataset, batch_size, shuffle=is_train)
   ```

   

6.é¢„æµ‹æ—¶ï¼Œå¯ä»¥

```python
net.eval()            # åˆ‡æ¢åˆ°è¯„ä¼°æ¨¡å¼ï¼ŒDropout & BatchNorm ç­‰å¤±æ´»ï¼Œå±è”½ä¸¢å¼ƒç¥ç»å…ƒçš„å½±å“
with torch.no_grad(): # ç¦æ­¢æ¢¯åº¦è®¡ç®—
...
```

### 3ã€` bank `ç«èµ›

1. æœ¬æ¬¡ç«èµ›ä¸­ï¼Œæˆ‘å¯¹ torch çš„åŸºæœ¬æŠ€å·§æ¯”è¾ƒç†Ÿç»ƒäº†ï¼Œå¹¶ä¸”èƒ½å¤Ÿä½¿ç”¨sklearnçš„æŠ€å·§å¯¹è®­ç»ƒé›†è¿›è¡Œåˆ’åˆ†ï¼Œå¹¶ä¸”è¿›è¡Œè¯„ä¼°ã€‚å¹¶ä¸”æˆ‘èƒ½å¤Ÿå…ˆåˆ’åˆ†æ•°æ®é›†æ¥è¯„ä¼°æ¨¡å‹çš„æ€§èƒ½ï¼Œä¹‹åå†åˆå¹¶æ•°æ®é›†å†æ¬¡è®­ç»ƒï¼Œå¹¶è¿›è¡Œæ­£åˆ™åŒ–æƒ©ç½šï¼Œè¾¾åˆ°äº†ä¸é”™çš„æ•ˆæœã€‚



### 4ã€`CIFAR-10`ç«èµ›

1.  æœ¬æ¬¡ç«èµ›ä¸­ï¼Œæˆ‘é‡åˆ°äº†ä¸å°‘çš„æŠ¥é”™å’ŒæŒ‘æˆ˜ï¼Œè¿™æ˜¯æˆ‘ç¬¬ä¸€æ¬¡åŸºæœ¬ç‹¬ç«‹å®Œæˆçš„å›¾åƒåˆ†ç±»ç«èµ›ã€‚

2. å¯¹æ•°æ®åšå˜æ¢æ—¶ï¼Œè¦è®°ç€ï¼Œä¸ä»…è¦å¯¹éªŒè¯é›†è¿˜è¦å¯¹æµ‹è¯•é›†åšåŒæ ·çš„å˜æ¢ã€‚

3.  æœ¬æ¬¡æ¯”èµ›æˆ‘è¿˜ä½¿ç”¨äº†å½’ä¸€åŒ–å¤„ç†ï¼Œå¦‚æœå›¾è±¡æ•°æ®æ¥è‡ªimagenetæˆ–è€…cifar10ï¼Œä½ éœ€è¦è®°ä½ä¸€äº›å‚æ•°ï¼Œå¦‚ä¸‹ã€‚å¦åˆ™ï¼Œéœ€è¦è‡ªå·±è®¡ç®—ç›¸åº”çš„å‚æ•°ï¼Œå¹¶è¿›è¡Œå¤„ç†ï¼Œå¦‚ä¸‹ã€‚ä½†æ˜¯è¿™æ ·çš„è¯å‡å€¼å’Œæ–¹å·®éƒ½æ˜¯tensorç±»å‹ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦æŠŠä»–ä»¬è½¬æ¢æˆåˆ—è¡¨æ ¼å¼ã€‚

   ```python
   <  imagenet  >
   mean = [0.4914, 0.4822, 0.4465]
   std  = [0.2023, 0.1994, 0.2010]
   
   <  cifar  >
   mean = [0.4914, 0.4822, 0.4465]
   std  = [0.2023, 0.1994, 0.2010]
   
   # å‡è®¾ train_data shape = (N, C, H, W)
   mean = train_data.mean(dim=[0,2,3])
   std  = train_data.std(dim=[0,2,3])
   transforms.Normalize(mean=mean.tolist(), std=std.tolist())
   ```

4. [åœ¨è¯»å–å›¾åƒæ•°æ®æ—¶ï¼Œå‚è§88](# 88ã€listdirï¼ˆï¼‰)

5. è¯»å–æ•°æ®ï¼Œæ— è®ºä»€ä¹ˆæ•°æ®æ—¶ï¼Œæœ€å¥½å°†è¿™ä¸€è¿‡ç¨‹å•ç‹¬æˆå•å…ƒæ ¼ä»¥åŠæ•°æ®åç§°ä¿è¯åªç”¨ä¸€æ¬¡ï¼Œè¿™æ ·çš„è¯ï¼Œæ•°æ®å°±ä¸ä¼šè¢«æ›´æ”¹ï¼Œä¹Ÿä¸ç”¨åå¤é‡æ–°è¯»å–äº†ã€‚æœ‰æ¡ä»¶çš„è¯ï¼ŒåŠ ä¸Štdqmï¼Œå¯ä»¥å¯è§†åŒ–è¿›åº¦ã€‚

6. å…³äºæ ‡ç­¾ç¼–ç é—®é¢˜ï¼Œå¦‚æœæ ‡ç­¾åªæœ‰ä¸€åˆ—çš„è¯ï¼Œç›´æ¥ä½¿ç”¨LabelEncoderæ›´å¥½ï¼Œå› ä¸ºä»–ä¼šç”Ÿæˆä¸€ä¸ª1d çš„ndarrayçš„æ•°æ®ï¼Œå±æ€§classes_è®°å½•æ˜ å°„å…³ç³»ã€‚è€ŒOrdinarEncoder è™½ç„¶ä¹Ÿèƒ½èµ·åˆ°åŒæ ·çš„ä½œç”¨ï¼Œä½†æ˜¯å®ƒè¿”å›çš„ndarrayæ˜¯å¤šç»´çš„ï¼Œæœ€å¥½è¿˜è¦å»ç»´ï¼Œæ¯”è¾ƒéº»çƒ¦ï¼Œè¿˜æ˜¯é€‚åˆå¤„ç†å¤šåˆ—æ•°æ®ï¼Œå±æ€§categories _ è®°å½•æ˜ å°„å…³ç³»ã€‚ç›¸åŒçš„æ˜¯ï¼ŒäºŒè€…éƒ½æ˜¯ä»0å¼€å§‹ç¼–ç ã€‚

7. Datasetæ˜¯ä¸€ä¸ªæ•°æ®é›†åŸºç±»ï¼Œä¸æ˜¯ä¸€ä¸ªæœ‰å…·ä½“åŠŸèƒ½çš„ç±»ã€‚å½“ä½ è¦å¯¹æ•°æ®è¿›è¡Œå¤„ç†æ¯”å¦‚å˜æ¢æ—¶ï¼Œä½ å°±å¯ä»¥åˆ›å»ºä¸€ä¸ªç»§æ‰¿Datasetçš„æ–°ç±»ã€‚

8. å…³äºè®¾å¤‡ï¼Œæœ€å¥½åœ¨ä¸€å¼€å§‹å°±æŒ‡å®šï¼Œè¿™æ ·å­æ¸…æ™°æ˜äº†

   ```python
   device=torch.device("cuda")
   ```

9. train_test_splitå‡½æ•°ä¹Ÿå¯ä»¥æ¥æ”¶å¼ é‡ï¼Œè¿™ç‚¹å€¼å¾—å…³æ³¨ã€‚

10. å­¦ä¼šä½¿ç”¨å­¦ä¹ ç‡è°ƒåº¦å»è¾…åŠ©è°ƒèŠ‚æ¨¡å‹æ€§èƒ½ï¼Œ[å‚è§](# 89ã€å­¦ä¹ ç‡è°ƒåº¦å™¨ï¼ˆç²¾ç®€ç‰ˆï¼‰)ã€‚

11. æŸå¤±çš„reductionå‚æ•°å¯ä»¥æ˜¯"mean"ï¼Œå½“è®¡ç®—æ€»æŸå¤±æ—¶ï¼Œç›´æ¥

    ```python
    loss_epoch+=loss.item()*len(y)
    ```

12. ç»˜åˆ¶æ›²çº¿æ—¶ï¼Œå¯ä»¥ç›´æ¥ç»˜åˆ¶è®­ç»ƒé›†æŸå¤±ã€è®­ç»ƒé›†å‡†ç¡®ç‡ï¼Œæµ‹è¯•é›†å‡†ç¡®
13. æœ€åï¼Œæœ¬æ¬¡ç«èµ›æ¶‰åŠçš„çŸ¥è¯†æ•´ç†èŒƒå›´å¦‚ä¸‹ï¼šï¼ˆ74~90ï¼‰ã€‚



### 5ã€`Kannada-MSIST` ç«èµ›

1. ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå°†æ•°æ®ä¿å­˜åœ¨cpuä¸Šï¼Œåœ¨è®­ç»ƒå¾ªç¯é‡Œé¢å†è°ƒæ•´deviceï¼Œæˆ–è€…è¯´åœ¨ç”¨åˆ°çš„æ—¶å€™å†è½¬ç§»è®¾å¤‡ï¼Œè¿™æ ·å°±ä¸ä¼šæ··æ·†äº†ã€‚
2. åœ¨è®¡ç®—è®­ç»ƒç²¾åº¦æ—¶ï¼Œä¸è¦ä¸€ä¸‹æŠŠæ•°æ®éƒ½æ”¾åˆ°gpuä¸Šè®­ç»ƒï¼Œä¼šé€ æˆå†…å­˜ä¸è¶³ï¼Œä¹Ÿæ˜¯åº”è¯¥åˆ†æ‰¹æ¬¡è®¡ç®—ã€‚è®¡ç®—éªŒè¯æŸå¤±æ—¶ä¹Ÿæ˜¯å¦‚æ­¤ã€‚åŒæ—¶ä½ è¿˜éœ€è¦æŠŠæ¨¡å‹è®¾ç½®æˆè¯„ä¼°æ¨¡å¼ï¼Œåœ¨å‡½æ•°æœ«å°¾è®¾ç½®ä¸ºè®­ç»ƒæ¨¡å¼ã€‚
3. çŠ¶æ€ä¾æ—§ç³Ÿç³•ï¼Œæƒ³æ”¾å¼ƒã€‚



### 6ã€`K-Means Clustering for Heart Disease Analysis` ç«èµ›

1. å¯¹äºpandasæ•°æ®ï¼Œç›´æ¥forå¾ªç¯éå†ï¼Œå¾—åˆ°çš„æ˜¯åˆ—å for col in dataã€‚
2. æœ¬æ¬¡ç«èµ›ï¼Œæˆ‘å­¦ä¹ å¹¶ç»ƒä¹ äº†èšç±»çŸ¥è¯†ï¼Œè®©æˆ‘å°è±¡æ·±åˆ»çš„æ˜¯æ•°æ®å¤„ç†ï¼Œä¹‹åå°±æ˜¯è‚˜éƒ¨æ³•ï¼ˆè¶Šå°è¶Šå¥½ï¼‰ï¼Œä»¥åŠsilouette_scoreï¼ˆè¶Šå¤§è¶Šå¥½ï¼‰ï¼Œä¹‹åå°±æ²¡ä»€ä¹ˆå¥½è¯´çš„äº†ã€‚
3. åŠ æ²¹



### 7ã€`bank`ç«èµ›ï¼ˆå›é¡¾ï¼Œé‡‡ç”¨ç»å…¸æœºå™¨å­¦ä¹ ï¼‰

#### 1ã€EDA 

1. å¯¹äºæ•°å€¼ç‰¹å¾è€Œè¨€ã€‚å½“æ•°æ®åæ–œï¼ˆæ•°æ®æœ‰ä¸ªå°å°¾å·´ï¼‰ï¼Œå³æ•°æ®åˆ†å¸ƒä¸å¯¹æˆä¸å‡åŒ€æ—¶ï¼Œç›´æ¥è®­ç»ƒçš„è¯ï¼Œåƒé€»è¾‘å›å½’ç­‰çº¿æ€§æ¨¡å‹å¯¹æç«¯å€¼æ•æ„Ÿï¼Œæ‹‰ä½è®­ç»ƒæ•ˆæœï¼›åƒç¥ç»ç½‘ç»œæ¨¡å‹ï¼Œå¯èƒ½ä¼šåœ¨æå¤§å€¼å¤„æ¢¯åº¦çˆ†ç‚¸æˆ–è€…æå°å€¼æ¢¯åº¦æ¶ˆå¤±ï¼›å¯¹äºæ ‘æ¨¡å‹ï¼Œå€’æ˜¯ä¸å½±å“ï¼Œæ¯•ç«Ÿä»–ä¸çœ‹å…·ä½“æ•°å€¼ï¼Œåªçœ‹åˆ†å¸ƒã€‚å¸¸ç”¨çš„æ‰‹æ®µæœ‰ pd.sqrtã€pd.cbrtï¼ˆç«‹æ–¹æ ¹ï¼‰ã€np.log1pç­‰ã€‚

```python
# å¯¹æ•°å˜æ¢ï¼Œnp.signè¡¨ç¤ºè¿”å›å„ä¸ªå…ƒç´ ç¬¦å·
 df['balance_log'] = (np.sign(df['balance']) * np.log1p(np.abs(df['balance']))).astype('float32')
    
# sin/cos å˜æ¢
df['week_sin'] = np.sin(2*np.pi*df['week_num']/7)
df['week_cos'] = np.cos(2*np.pi*df['week_num']/7)

#åˆ†ç®±æ“ä½œï¼Œä½ å¯ä»¥å…ˆè¿›è¡Œæ•°æ®å˜æ¢ï¼Œä¹‹åè¿›è¡Œåˆ†ç®±
df['duration_bin_20'] = pd.qcut(
    df['duration'],      # è¦åˆ†ç®±çš„è¿ç»­ç‰¹å¾
    q=20,               # åˆ†æˆ20ä¸ªç®±ï¼ˆæ¯ç®±å¤§çº¦5%çš„æ ·æœ¬ï¼‰
    labels=False,       # ç”¨æ•´æ•°æ ‡ç­¾è¡¨ç¤ºç®±å·ï¼Œè€Œä¸æ˜¯è¿”å›åŒºé—´å¯¹è±¡
    duplicates='drop'   # å¦‚æœåˆ†ä½ç‚¹æœ‰é‡å¤å€¼ï¼Œä¸¢æ‰é‡å¤çš„ç®±ï¼Œé¿å…æŠ¥é”™
)
```



2. å¯¹äºæ•°å€¼ç‰¹å¾è€Œè¨€ï¼Œæœ‰æ—¶ï¼Œæˆ‘ä»¬ä¹Ÿé€šè¿‡å¤šç§å˜æ¢æ„å»ºæ–°çš„ç‰¹å¾ä»¥å¸®åŠ©æ¨¡å‹è®­ç»ƒï¼Œå°±æ¯”å¦‚ä¸»åŠ¨sqrtã€sin\coså˜æ¢ã€åˆ†ç®±æ“ä½œ

3. å¯¹äºéæ•°å€¼åˆ—è€Œè¨€ï¼Œä»€ä¹ˆæ—¶å€™ä½¿ç”¨ OneHotEncoder ï¼Œä»€ä¹ˆæ—¶å€™ä½¿ç”¨  OrdinalEncoder  ï¼Œä»¥åŠä»€ä¹ˆæ—¶å€™ å¯¹æ•°æ®è¿›è¡Œsinï¼Œcoså¤„ç†å‘¢ã€‚æˆ‘çš„çœ‹æ³•æ˜¯ï¼šå½“æ•°æ®å­˜åœ¨æ˜æ˜¾çš„é¡ºåºå…³ç³»ä½†ä¸æ˜¯å‘¨æœŸæ€§æ—¶ï¼Œå°±æ¯”å¦‚æœ¬ç§‘->ç¡•å£«->åšå£«ï¼Œè¿™æ—¶å€™ä½¿ç”¨ OrdinalEncoder æˆ–è€… LabelEncoder å°±æŒºå¥½çš„ã€‚å½“æ•°æ®ç±»äº’ä¸ç›¸å…³æ—¶ï¼Œç›´æ¥ç”¨One Hot Encoderæ˜¯æœ€ä½³é€‰æ‹©ã€‚å½“ä½ å‘ç°æ•°æ®å­˜åœ¨å‘¨æœŸæ€§æ—¶ï¼Œé‚£å°±ä½¿ç”¨ sinã€coså¤„ç†æ•°æ®ï¼Œä½†è¦æ³¨æ„ä½ éœ€è¦å…ˆæŠŠéçº¿æ€§å€¼æ˜ å°„åˆ°çº¿æ€§å€¼ï¼Œä¹‹åå†ç”¨è¯¥æ–¹æ³•å¤„ç†ã€‚

#### 2ã€è¶…å‚æ•°æœç´¢

å½“æ•°æ®é‡å¤§æ—¶ï¼Œé‡‡ç”¨ç›´æ–¹å›¾æ¢¯åº¦æå‡æ˜¯ä¸ªä¸é”™çš„æ–¹æ³•ï¼Œæ•ˆç‡é«˜ã€‚å¹¶ä¸”å¯ä»¥ä½¿ç”¨éšæœºæœç´¢çš„æ–¹æ³•ï¼Œä¸€å¼€å§‹ä½¿ç”¨æ•°æ®çš„50%è®­ç»ƒï¼Œä¹‹åä¸æ–­æé«˜æ¯”ä¾‹ï¼Œ70%å·¦å³æ—¶ï¼Œå¯ä»¥åœä¸‹ã€‚ä¹‹åå†æ¬¡è¿è¡Œä¸€ä¸‹ï¼Œçœ‹çœ‹è¶…å‚æ•°è§„å¾‹æ˜¯ä¸æ˜¯å¶ç„¶ã€‚ä¹‹åï¼Œä½¿ç”¨å…¨éƒ¨æ•°æ®æ‹Ÿåˆï¼Œä½†ä¸å†æœç´¢è¶…å‚æ•°ï¼Œå¹¶æ ¹æ®ä¹‹å‰çš„è§„å¾‹é€‚å½“è°ƒæ•´è¶…å‚æ•°ï¼Œä¸æ­¤åŒæ—¶ä¸æ–­ç”¨éªŒè¯é›†æµ‹è¯•ã€‚

æœ€åï¼Œä½¿ç”¨trainå’Œvalæ•°æ®ä¸­çš„0.9è®­ç»ƒï¼Œ0.1ä½œä¸ºå‚è€ƒï¼Œå¾—åˆ°çš„æ¨¡å‹ç›´æ¥æµ‹è¯•ã€‚æˆ–è€…ä½¿ç”¨å…¨éƒ¨æ•°æ®ï¼Œç”¨kaggleç»“æœè§‚å¯Ÿæ•ˆæœã€‚

#### 3ã€TEï¼ˆç±»åˆ«ç¼–ç ï¼‰

è§åˆ°äº†ä¸€ä¸ªæ–°çš„å˜æ¢å™¨FunctionTransformerï¼ˆfunctionï¼‰ï¼Œå¯ä»¥å¯¹æ•°æ®ç›´æ¥è¿›è¡Œå˜æ¢ã€‚

#### 4ã€æ•°æ®æ˜¾ç¤º

1. plt.xticks(rotation=45)è°ƒæ•´xè½´æ ‡ç­¾è§’åº¦ï¼Œå¸¸åœ¨ç±»è¢«è¾ƒå¤šæ—¶ä½¿ç”¨ã€‚
2.  percentage_data=(train_data.groupby(col["y"].value_counts(normalize=True).rename("percentage").reset_index())å¯ä»¥æŒ‰ç±»åˆ«æ˜¾ç¤ºï¼Œåé¢å†è·Ÿä¸Šbarplotæ˜¾ç¤ºï¼Œå³æ¡å½¢å›¾æ˜¾ç¤ºã€‚

3. histplotï¼Œå³ç›´æ–¹å›¾æ˜¾ç¤ºï¼Œæ˜¾ç¤ºè¿ç»­æ•°æ®åˆ†å¸ƒã€‚

### 8ã€`cat and dog ` åˆ†ç±»ç«èµ›

ä¸€å¨

